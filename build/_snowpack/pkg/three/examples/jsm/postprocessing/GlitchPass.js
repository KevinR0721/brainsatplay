import{fG as l,S as u,cO as a,l as f,R as m,F as d}from"../../../../common/three.module-f256b224.js";import{P as n}from"../../../../common/Pass-35d0974f.js";import{D as h}from"../../../../common/DigitalGlitch-2b3e1210.js";var o=function(t){n.call(this),h===void 0&&console.error("THREE.GlitchPass relies on DigitalGlitch");var r=h;this.uniforms=l.clone(r.uniforms),t==null&&(t=64),this.uniforms.tDisp.value=this.generateHeightmap(t),this.material=new u({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.fsQuad=new n.FullScreenQuad(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()};o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,render:function(t,r,i){this.uniforms.tDiffuse.value=i.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||this.goWild==!0?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=a.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=a.randFloat(-1,1),this.uniforms.seed_y.value=a.randFloat(-1,1),this.uniforms.distortion_x.value=a.randFloat(0,1),this.uniforms.distortion_y.value=a.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=a.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=a.randFloat(0,1),this.uniforms.distortion_y.value=a.randFloat(0,1),this.uniforms.seed_x.value=a.randFloat(-.3,.3),this.uniforms.seed_y.value=a.randFloat(-.3,.3)):this.goWild==!1&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(r),this.clear&&t.clear(),this.fsQuad.render(t))},generateTrigger:function(){this.randX=a.randInt(120,240)},generateHeightmap:function(t){for(var r=new Float32Array(t*t*3),i=t*t,e=0;e<i;e++){var s=a.randFloat(0,1);r[e*3+0]=s,r[e*3+1]=s,r[e*3+2]=s}return new f(r,t,t,m,d)}});export{o as GlitchPass};
