{"version":3,"file":"GlitchPass.js","sources":["../../../../../../../node_modules/three/examples/jsm/postprocessing/GlitchPass.js"],"sourcesContent":["import {\n\tDataTexture,\n\tFloatType,\n\tMathUtils,\n\tRGBFormat,\n\tShaderMaterial,\n\tUniformsUtils\n} from '../../../build/three.module.js';\nimport { Pass } from '../postprocessing/Pass.js';\nimport { DigitalGlitch } from '../shaders/DigitalGlitch.js';\n\nvar GlitchPass = function ( dt_size ) {\n\n\tPass.call( this );\n\n\tif ( DigitalGlitch === undefined ) console.error( 'THREE.GlitchPass relies on DigitalGlitch' );\n\n\tvar shader = DigitalGlitch;\n\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\tif ( dt_size == undefined ) dt_size = 64;\n\n\n\tthis.uniforms[ 'tDisp' ].value = this.generateHeightmap( dt_size );\n\n\n\tthis.material = new ShaderMaterial( {\n\t\tuniforms: this.uniforms,\n\t\tvertexShader: shader.vertexShader,\n\t\tfragmentShader: shader.fragmentShader\n\t} );\n\n\tthis.fsQuad = new Pass.FullScreenQuad( this.material );\n\n\tthis.goWild = false;\n\tthis.curF = 0;\n\tthis.generateTrigger();\n\n};\n\nGlitchPass.prototype = Object.assign( Object.create( Pass.prototype ), {\n\n\tconstructor: GlitchPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tthis.uniforms[ 'tDiffuse' ].value = readBuffer.texture;\n\t\tthis.uniforms[ 'seed' ].value = Math.random();//default seeding\n\t\tthis.uniforms[ 'byp' ].value = 0;\n\n\t\tif ( this.curF % this.randX == 0 || this.goWild == true ) {\n\n\t\t\tthis.uniforms[ 'amount' ].value = Math.random() / 30;\n\t\t\tthis.uniforms[ 'angle' ].value = MathUtils.randFloat( - Math.PI, Math.PI );\n\t\t\tthis.uniforms[ 'seed_x' ].value = MathUtils.randFloat( - 1, 1 );\n\t\t\tthis.uniforms[ 'seed_y' ].value = MathUtils.randFloat( - 1, 1 );\n\t\t\tthis.uniforms[ 'distortion_x' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'distortion_y' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.curF = 0;\n\t\t\tthis.generateTrigger();\n\n\t\t} else if ( this.curF % this.randX < this.randX / 5 ) {\n\n\t\t\tthis.uniforms[ 'amount' ].value = Math.random() / 90;\n\t\t\tthis.uniforms[ 'angle' ].value = MathUtils.randFloat( - Math.PI, Math.PI );\n\t\t\tthis.uniforms[ 'distortion_x' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'distortion_y' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'seed_x' ].value = MathUtils.randFloat( - 0.3, 0.3 );\n\t\t\tthis.uniforms[ 'seed_y' ].value = MathUtils.randFloat( - 0.3, 0.3 );\n\n\t\t} else if ( this.goWild == false ) {\n\n\t\t\tthis.uniforms[ 'byp' ].value = 1;\n\n\t\t}\n\n\t\tthis.curF ++;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\tif ( this.clear ) renderer.clear();\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t},\n\n\tgenerateTrigger: function () {\n\n\t\tthis.randX = MathUtils.randInt( 120, 240 );\n\n\t},\n\n\tgenerateHeightmap: function ( dt_size ) {\n\n\t\tvar data_arr = new Float32Array( dt_size * dt_size * 3 );\n\t\tvar length = dt_size * dt_size;\n\n\t\tfor ( var i = 0; i < length; i ++ ) {\n\n\t\t\tvar val = MathUtils.randFloat( 0, 1 );\n\t\t\tdata_arr[ i * 3 + 0 ] = val;\n\t\t\tdata_arr[ i * 3 + 1 ] = val;\n\t\t\tdata_arr[ i * 3 + 2 ] = val;\n\n\t\t}\n\n\t\treturn new DataTexture( data_arr, dt_size, dt_size, RGBFormat, FloatType );\n\n\t}\n\n} );\n\nexport { GlitchPass };\n"],"names":[],"mappings":"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"}