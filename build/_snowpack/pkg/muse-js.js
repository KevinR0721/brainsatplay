import{c as vt,a as z}from"./common/_commonjsHelpers-4f955397.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var At=function(n,e){return At=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},At(n,e)};function l(n,e){At(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function K(n){return typeof n=="function"}var re=!1,j={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){var e=new Error;""+e.stack}re=n},get useDeprecatedSynchronousErrorHandling(){return re}};function J(n){setTimeout(function(){throw n},0)}var yt={closed:!0,next:function(n){},error:function(n){if(j.useDeprecatedSynchronousErrorHandling)throw n;J(n)},complete:function(){}},N=function(){return Array.isArray||function(n){return n&&typeof n.length=="number"}}();function Vt(n){return n!==null&&typeof n=="object"}var nn=function(){function n(e){return Error.call(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(t,r){return r+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n}(),it=nn,g=function(){function n(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return n.prototype.unsubscribe=function(){var e;if(!this.closed){var t=this,r=t._parentOrParents,i=t._ctorUnsubscribe,o=t._unsubscribe,s=t._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof n)r.remove(this);else if(r!==null)for(var u=0;u<r.length;++u){var c=r[u];c.remove(this)}if(K(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(f){e=f instanceof it?ie(f.errors):[f]}}if(N(s))for(var u=-1,h=s.length;++u<h;){var p=s[u];if(Vt(p))try{p.unsubscribe()}catch(a){e=e||[],a instanceof it?e=e.concat(ie(a.errors)):e.push(a)}}if(e)throw new it(e)}},n.prototype.add=function(e){var t=e;if(!e)return n.EMPTY;switch(typeof e){case"function":t=new n(e);case"object":if(t===this||t.closed||typeof t.unsubscribe!="function")return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof n)){var r=t;t=new n,t._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=t._parentOrParents;if(i===null)t._parentOrParents=this;else if(i instanceof n){if(i===this)return t;t._parentOrParents=[i,this]}else if(i.indexOf(this)===-1)i.push(this);else return t;var o=this._subscriptions;return o===null?this._subscriptions=[t]:o.push(t),t},n.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);r!==-1&&t.splice(r,1)}},n.EMPTY=function(e){return e.closed=!0,e}(new n),n}();function ie(n){return n.reduce(function(e,t){return e.concat(t instanceof it?t.errors:t)},[])}var mt=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),b=function(n){l(e,n);function e(t,r,i){var o=n.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=yt;break;case 1:if(!t){o.destination=yt;break}if(typeof t=="object"){t instanceof e?(o.syncErrorThrowable=t.syncErrorThrowable,o.destination=t,t.add(o)):(o.syncErrorThrowable=!0,o.destination=new oe(o,t));break}default:o.syncErrorThrowable=!0,o.destination=new oe(o,t,r,i);break}return o}return e.prototype[mt]=function(){return this},e.create=function(t,r,i){var o=new e(t,r,i);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(g),oe=function(n){l(e,n);function e(t,r,i,o){var s=n.call(this)||this;s._parentSubscriber=t;var u,c=s;return K(r)?u=r:r&&(u=r.next,i=r.error,o=r.complete,r!==yt&&(c=Object.create(r),K(c.unsubscribe)&&s.add(c.unsubscribe.bind(c)),c.unsubscribe=s.unsubscribe.bind(s))),s._context=c,s._next=u,s._error=i,s._complete=o,s}return e.prototype.next=function(t){if(!this.isStopped&&this._next){var r=this._parentSubscriber;!j.useDeprecatedSynchronousErrorHandling||!r.syncErrorThrowable?this.__tryOrUnsub(this._next,t):this.__tryOrSetError(r,this._next,t)&&this.unsubscribe()}},e.prototype.error=function(t){if(!this.isStopped){var r=this._parentSubscriber,i=j.useDeprecatedSynchronousErrorHandling;if(this._error)!i||!r.syncErrorThrowable?(this.__tryOrUnsub(this._error,t),this.unsubscribe()):(this.__tryOrSetError(r,this._error,t),this.unsubscribe());else if(r.syncErrorThrowable)i?(r.syncErrorValue=t,r.syncErrorThrown=!0):J(t),this.unsubscribe();else{if(this.unsubscribe(),i)throw t;J(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var r=this._parentSubscriber;if(this._complete){var i=function(){return t._complete.call(t._context)};!j.useDeprecatedSynchronousErrorHandling||!r.syncErrorThrowable?(this.__tryOrUnsub(i),this.unsubscribe()):(this.__tryOrSetError(r,i),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,r){try{t.call(this._context,r)}catch(i){if(this.unsubscribe(),j.useDeprecatedSynchronousErrorHandling)throw i;J(i)}},e.prototype.__tryOrSetError=function(t,r,i){if(!j.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{r.call(this._context,i)}catch(o){return j.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=o,t.syncErrorThrown=!0,!0):(J(o),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(b);function kt(n){for(;n;){var e=n,t=e.closed,r=e.destination,i=e.isStopped;if(t||i)return!1;r&&r instanceof b?n=r:n=null}return!0}function rn(n,e,t){if(n){if(n instanceof b)return n;if(n[mt])return n[mt]()}return!n&&!e&&!t?new b(yt):new b(n,e,t)}var Z=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function L(n){return n}function jt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return se(n)}function se(n){return n.length===0?L:n.length===1?n[0]:function(t){return n.reduce(function(r,i){return i(r)},t)}}var m=function(){function n(e){this._isScalar=!1,e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this.operator,o=rn(e,t,r);if(i?o.add(i.call(o,this.source)):o.add(this.source||j.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),j.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){j.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),kt(e)?e.error(t):console.warn(t)}},n.prototype.forEach=function(e,t){var r=this;return t=ue(t),new t(function(i,o){var s;s=r.subscribe(function(u){try{e(u)}catch(c){o(c),s&&s.unsubscribe()}},o,i)})},n.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},n.prototype[Z]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length===0?this:se(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=ue(e),new e(function(r,i){var o;t.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},n.create=function(e){return new n(e)},n}();function ue(n){if(n||(n=j.Promise||Promise),!n)throw new Error("no Promise impl found");return n}var on=function(){function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n}(),q=on,ce=function(n){l(e,n);function e(t,r){var i=n.call(this)||this;return i.subject=t,i.subscriber=r,i.closed=!1,i}return e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,r=t.observers;if(this.subject=null,!(!r||r.length===0||t.isStopped||t.closed)){var i=r.indexOf(this.subscriber);i!==-1&&r.splice(i,1)}}},e}(g),ae=function(n){l(e,n);function e(t){var r=n.call(this,t)||this;return r.destination=t,r}return e}(b),C=function(n){l(e,n);function e(){var t=n.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype[mt]=function(){return new ae(this)},e.prototype.lift=function(t){var r=new fe(this,this);return r.operator=t,r},e.prototype.next=function(t){if(this.closed)throw new q;if(!this.isStopped)for(var r=this.observers,i=r.length,o=r.slice(),s=0;s<i;s++)o[s].next(t)},e.prototype.error=function(t){if(this.closed)throw new q;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var r=this.observers,i=r.length,o=r.slice(),s=0;s<i;s++)o[s].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new q;this.isStopped=!0;for(var t=this.observers,r=t.length,i=t.slice(),o=0;o<r;o++)i[o].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(t){if(this.closed)throw new q;return n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){if(this.closed)throw new q;return this.hasError?(t.error(this.thrownError),g.EMPTY):this.isStopped?(t.complete(),g.EMPTY):(this.observers.push(t),new ce(this,t))},e.prototype.asObservable=function(){var t=new m;return t.source=this,t},e.create=function(t,r){return new fe(t,r)},e}(m),fe=function(n){l(e,n);function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return e.prototype.next=function(t){var r=this.destination;r&&r.next&&r.next(t)},e.prototype.error=function(t){var r=this.destination;r&&r.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){var r=this.source;return r?this.source.subscribe(t):g.EMPTY},e}(C);function Rt(){return function(e){return e.lift(new sn(e))}}var sn=function(){function n(e){this.connectable=e}return n.prototype.call=function(e,t){var r=this.connectable;r._refCount++;var i=new un(e,r),o=t.subscribe(i);return i.closed||(i.connection=r.connect()),o},n}(),un=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.connectable=r,i}return e.prototype._unsubscribe=function(){var t=this.connectable;if(!t){this.connection=null;return}this.connectable=null;var r=t._refCount;if(r<=0){this.connection=null;return}if(t._refCount=r-1,r>1){this.connection=null;return}var i=this.connection,o=t._connection;this.connection=null,o&&(!i||o===i)&&o.unsubscribe()},e}(b),he=function(n){l(e,n);function e(t,r){var i=n.call(this)||this;return i.source=t,i.subjectFactory=r,i._refCount=0,i._isComplete=!1,i}return e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,t=this._connection=new g,t.add(this.source.subscribe(new an(this.getSubject(),this))),t.closed&&(this._connection=null,t=g.EMPTY)),t},e.prototype.refCount=function(){return Rt()(this)},e}(m),cn=function(){var n=he.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}}(),an=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.connectable=r,i}return e.prototype._error=function(t){this._unsubscribe(),n.prototype._error.call(this,t)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),n.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var r=t._connection;t._refCount=0,t._subject=null,t._connection=null,r&&r.unsubscribe()}},e}(ae);function fn(n,e,t,r){return function(i){return i.lift(new hn(n,e,t,r))}}var hn=function(){function n(e,t,r,i){this.keySelector=e,this.elementSelector=t,this.durationSelector=r,this.subjectSelector=i}return n.prototype.call=function(e,t){return t.subscribe(new ln(e,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},n}(),ln=function(n){l(e,n);function e(t,r,i,o,s){var u=n.call(this,t)||this;return u.keySelector=r,u.elementSelector=i,u.durationSelector=o,u.subjectSelector=s,u.groups=null,u.attemptedToUnsubscribe=!1,u.count=0,u}return e.prototype._next=function(t){var r;try{r=this.keySelector(t)}catch(i){this.error(i);return}this._group(t,r)},e.prototype._group=function(t,r){var i=this.groups;i||(i=this.groups=new Map);var o=i.get(r),s;if(this.elementSelector)try{s=this.elementSelector(t)}catch(h){this.error(h)}else s=t;if(!o){o=this.subjectSelector?this.subjectSelector():new C,i.set(r,o);var u=new Wt(r,o,this);if(this.destination.next(u),this.durationSelector){var c=void 0;try{c=this.durationSelector(new Wt(r,o))}catch(h){this.error(h);return}this.add(c.subscribe(new pn(r,o,this)))}}o.closed||o.next(s)},e.prototype._error=function(t){var r=this.groups;r&&(r.forEach(function(i,o){i.error(t)}),r.clear()),this.destination.error(t)},e.prototype._complete=function(){var t=this.groups;t&&(t.forEach(function(r,i){r.complete()}),t.clear()),this.destination.complete()},e.prototype.removeGroup=function(t){this.groups.delete(t)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&n.prototype.unsubscribe.call(this))},e}(b),pn=function(n){l(e,n);function e(t,r,i){var o=n.call(this,r)||this;return o.key=t,o.group=r,o.parent=i,o}return e.prototype._next=function(t){this.complete()},e.prototype._unsubscribe=function(){var t=this,r=t.parent,i=t.key;this.key=this.parent=null,r&&r.removeGroup(i)},e}(b),Wt=function(n){l(e,n);function e(t,r,i){var o=n.call(this)||this;return o.key=t,o.groupSubject=r,o.refCountSubscription=i,o}return e.prototype._subscribe=function(t){var r=new g,i=this,o=i.refCountSubscription,s=i.groupSubject;return o&&!o.closed&&r.add(new bn(o)),r.add(s.subscribe(t)),r},e}(m),bn=function(n){l(e,n);function e(t){var r=n.call(this)||this;return r.parent=t,t.count++,r}return e.prototype.unsubscribe=function(){var t=this.parent;!t.closed&&!this.closed&&(n.prototype.unsubscribe.call(this),t.count-=1,t.count===0&&t.attemptedToUnsubscribe&&t.unsubscribe())},e}(g),le=function(n){l(e,n);function e(t){var r=n.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return r&&!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new q;return this._value},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(C),dn=function(n){l(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(g),ot=function(n){l(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(t,r){if(r===void 0&&(r=0),this.closed)return this;this.state=t;var i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(o,this.id,r),this},e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,r,i){if(i===void 0&&(i=0),i!==null&&this.delay===i&&this.pending===!1)return r;clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var i=!1,o=void 0;try{this.work(t)}catch(s){i=!0,o=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),o},e.prototype._unsubscribe=function(){var t=this.id,r=this.scheduler,i=r.actions,o=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,o!==-1&&i.splice(o,1),t!=null&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null},e}(dn),vn=function(n){l(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i}return e.prototype.schedule=function(t,r){return r===void 0&&(r=0),r>0?n.prototype.schedule.call(this,t,r):(this.delay=r,this.state=t,this.scheduler.flush(this),this)},e.prototype.execute=function(t,r){return r>0||this.closed?n.prototype.execute.call(this,t,r):this._execute(t,r)},e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),i!==null&&i>0||i===null&&this.delay>0?n.prototype.requestAsyncId.call(this,t,r,i):t.flush(this)},e}(ot),Ft=function(){function n(e,t){t===void 0&&(t=n.now),this.SchedulerAction=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.SchedulerAction(this,e).schedule(r,t)},n.now=function(){return Date.now()},n}(),st=function(n){l(e,n);function e(t,r){r===void 0&&(r=Ft.now);var i=n.call(this,t,function(){return e.delegate&&e.delegate!==i?e.delegate.now():r()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return e.prototype.schedule=function(t,r,i){return r===void 0&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(t,r,i):n.prototype.schedule.call(this,t,r,i)},e.prototype.flush=function(t){var r=this.actions;if(this.active){r.push(t);return}var i;this.active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=r.shift());if(this.active=!1,i){for(;t=r.shift();)t.unsubscribe();throw i}},e}(Ft),yn=function(n){l(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(st),pe=new yn(vn),be=pe,X=new m(function(n){return n.complete()});function tt(n){return n?mn(n):X}function mn(n){return new m(function(e){return n.schedule(function(){return e.complete()})})}function V(n){return n&&typeof n.schedule=="function"}var de=function(n){return function(e){for(var t=0,r=n.length;t<r&&!e.closed;t++)e.next(n[t]);e.complete()}};function Mt(n,e){return new m(function(t){var r=new g,i=0;return r.add(e.schedule(function(){if(i===n.length){t.complete();return}t.next(n[i++]),t.closed||r.add(this.schedule())})),r})}function ut(n,e){return e?Mt(n,e):new m(de(n))}function wt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n[n.length-1];return V(t)?(n.pop(),Mt(n,t)):ut(n)}function Pt(n,e){return e?new m(function(t){return e.schedule(wn,0,{error:n,subscriber:t})}):new m(function(t){return t.error(n)})}function wn(n){var e=n.error,t=n.subscriber;t.error(e)}var Dt;Dt||(Dt={});var M=function(){function n(e,t,r){this.kind=e,this.value=t,this.error=r,this.hasValue=e==="N"}return n.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},n.prototype.do=function(e,t,r){var i=this.kind;switch(i){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return r&&r()}},n.prototype.accept=function(e,t,r){return e&&typeof e.next=="function"?this.observe(e):this.do(e,t,r)},n.prototype.toObservable=function(){var e=this.kind;switch(e){case"N":return wt(this.value);case"E":return Pt(this.error);case"C":return tt()}throw new Error("unexpected notification kind value")},n.createNext=function(e){return typeof e!="undefined"?new n("N",e):n.undefinedValueNotification},n.createError=function(e){return new n("E",void 0,e)},n.createComplete=function(){return n.completeNotification},n.completeNotification=new n("C"),n.undefinedValueNotification=new n("N",void 0),n}();function Sn(n,e){return e===void 0&&(e=0),function(r){return r.lift(new gn(n,e))}}var gn=function(){function n(e,t){t===void 0&&(t=0),this.scheduler=e,this.delay=t}return n.prototype.call=function(e,t){return t.subscribe(new ve(e,this.scheduler,this.delay))},n}(),ve=function(n){l(e,n);function e(t,r,i){i===void 0&&(i=0);var o=n.call(this,t)||this;return o.scheduler=r,o.delay=i,o}return e.dispatch=function(t){var r=t.notification,i=t.destination;r.observe(i),this.unsubscribe()},e.prototype.scheduleMessage=function(t){var r=this.destination;r.add(this.scheduler.schedule(e.dispatch,this.delay,new xn(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(M.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(M.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(M.createComplete()),this.unsubscribe()},e}(b),xn=function(){function n(e,t){this.notification=e,this.destination=t}return n}(),Bt=function(n){l(e,n);function e(t,r,i){t===void 0&&(t=Number.POSITIVE_INFINITY),r===void 0&&(r=Number.POSITIVE_INFINITY);var o=n.call(this)||this;return o.scheduler=i,o._events=[],o._infiniteTimeWindow=!1,o._bufferSize=t<1?1:t,o._windowTime=r<1?1:r,r===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=!0,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return e.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var r=this._events;r.push(t),r.length>this._bufferSize&&r.shift()}n.prototype.next.call(this,t)},e.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new _n(this._getNow(),t)),this._trimBufferThenGetEvents()),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){var r=this._infiniteTimeWindow,i=r?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,s=i.length,u;if(this.closed)throw new q;if(this.isStopped||this.hasError?u=g.EMPTY:(this.observers.push(t),u=new ce(this,t)),o&&t.add(t=new ve(t,o)),r)for(var c=0;c<s&&!t.closed;c++)t.next(i[c]);else for(var c=0;c<s&&!t.closed;c++)t.next(i[c].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),u},e.prototype._getNow=function(){return(this.scheduler||be).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),r=this._bufferSize,i=this._windowTime,o=this._events,s=o.length,u=0;u<s&&!(t-o[u].time<i);)u++;return s>r&&(u=Math.max(u,s-r)),u>0&&o.splice(0,u),o},e}(C),_n=function(){function n(e,t){this.time=e,this.value=t}return n}(),et=function(n){l(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return e.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),g.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),g.EMPTY):n.prototype._subscribe.call(this,t)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(t){this.hasCompleted||n.prototype.error.call(this,t)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&n.prototype.next.call(this,this.value),n.prototype.complete.call(this)},e}(C),En=1,Tn=function(){return Promise.resolve()}(),Ut={};function ye(n){return n in Ut?(delete Ut[n],!0):!1}var me={setImmediate:function(n){var e=En++;return Ut[e]=!0,Tn.then(function(){return ye(e)&&n()}),e},clearImmediate:function(n){ye(n)}},Cn=function(n){l(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i}return e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),i!==null&&i>0?n.prototype.requestAsyncId.call(this,t,r,i):(t.actions.push(this),t.scheduled||(t.scheduled=me.setImmediate(t.flush.bind(t,null))))},e.prototype.recycleAsyncId=function(t,r,i){if(i===void 0&&(i=0),i!==null&&i>0||i===null&&this.delay>0)return n.prototype.recycleAsyncId.call(this,t,r,i);t.actions.length===0&&(me.clearImmediate(r),t.scheduled=void 0)},e}(ot),On=function(n){l(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var r=this.actions,i,o=-1,s=r.length;t=t||r.shift();do if(i=t.execute(t.state,t.delay))break;while(++o<s&&(t=r.shift()));if(this.active=!1,i){for(;++o<s&&(t=r.shift());)t.unsubscribe();throw i}},e}(st),we=new On(Cn),St=we,Se=new st(ot),A=Se,In=function(n){l(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i}return e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),i!==null&&i>0?n.prototype.requestAsyncId.call(this,t,r,i):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(function(){return t.flush(null)})))},e.prototype.recycleAsyncId=function(t,r,i){if(i===void 0&&(i=0),i!==null&&i>0||i===null&&this.delay>0)return n.prototype.recycleAsyncId.call(this,t,r,i);t.actions.length===0&&(cancelAnimationFrame(r),t.scheduled=void 0)},e}(ot),Nn=function(n){l(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var r=this.actions,i,o=-1,s=r.length;t=t||r.shift();do if(i=t.execute(t.state,t.delay))break;while(++o<s&&(t=r.shift()));if(this.active=!1,i){for(;++o<s&&(t=r.shift());)t.unsubscribe();throw i}},e}(st),ge=new Nn(In),An=ge,Vn=function(n){l(e,n);function e(t,r){t===void 0&&(t=xe),r===void 0&&(r=Number.POSITIVE_INFINITY);var i=n.call(this,t,function(){return i.frame})||this;return i.maxFrames=r,i.frame=0,i.index=-1,i}return e.prototype.flush=function(){for(var t=this,r=t.actions,i=t.maxFrames,o,s;(s=r[0])&&s.delay<=i&&(r.shift(),this.frame=s.delay,!(o=s.execute(s.state,s.delay))););if(o){for(;s=r.shift();)s.unsubscribe();throw o}},e.frameTimeFactor=10,e}(st),xe=function(n){l(e,n);function e(t,r,i){i===void 0&&(i=t.index+=1);var o=n.call(this,t,r)||this;return o.scheduler=t,o.work=r,o.index=i,o.active=!0,o.index=t.index=i,o}return e.prototype.schedule=function(t,r){if(r===void 0&&(r=0),!this.id)return n.prototype.schedule.call(this,t,r);this.active=!1;var i=new e(this.scheduler,this.work);return this.add(i),i.schedule(t,r)},e.prototype.requestAsyncId=function(t,r,i){i===void 0&&(i=0),this.delay=t.frame+i;var o=t.actions;return o.push(this),o.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(t,r,i){},e.prototype._execute=function(t,r){if(this.active===!0)return n.prototype._execute.call(this,t,r)},e.sortActions=function(t,r){return t.delay===r.delay?t.index===r.index?0:t.index>r.index?1:-1:t.delay>r.delay?1:-1},e}(ot);function W(){}function kn(n){return!!n&&(n instanceof m||typeof n.lift=="function"&&typeof n.subscribe=="function")}var jn=function(){function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n}(),nt=jn,Rn=function(){function n(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return n.prototype=Object.create(Error.prototype),n}(),ct=Rn,Wn=function(){function n(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return n.prototype=Object.create(Error.prototype),n}(),_e=Wn;function R(n,e){return function(r){if(typeof n!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new Fn(n,e))}}var Fn=function(){function n(e,t){this.project=e,this.thisArg=t}return n.prototype.call=function(e,t){return t.subscribe(new Mn(e,this.project,this.thisArg))},n}(),Mn=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.project=r,o.count=0,o.thisArg=i||o,o}return e.prototype._next=function(t){var r;try{r=this.project.call(this.thisArg,t,this.count++)}catch(i){this.destination.error(i);return}this.destination.next(r)},e}(b);function Ee(n,e,t){if(e)if(V(e))t=e;else return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return Ee(n,t).apply(void 0,r).pipe(R(function(o){return N(o)?e.apply(void 0,o):e(o)}))};return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=this,s,u={context:o,subject:s,callbackFunc:n,scheduler:t};return new m(function(c){if(t){var p={args:r,subscriber:c,params:u};return t.schedule(Pn,0,p)}else{if(!s){s=new et;var h=function(){for(var f=[],a=0;a<arguments.length;a++)f[a]=arguments[a];s.next(f.length<=1?f[0]:f),s.complete()};try{n.apply(o,r.concat([h]))}catch(f){kt(s)?s.error(f):console.warn(f)}}return s.subscribe(c)}})}}function Pn(n){var e=this,t=n.args,r=n.subscriber,i=n.params,o=i.callbackFunc,s=i.context,u=i.scheduler,c=i.subject;if(!c){c=i.subject=new et;var h=function(){for(var p=[],f=0;f<arguments.length;f++)p[f]=arguments[f];var a=p.length<=1?p[0]:p;e.add(u.schedule(Dn,0,{value:a,subject:c}))};try{o.apply(s,t.concat([h]))}catch(p){c.error(p)}}this.add(c.subscribe(r))}function Dn(n){var e=n.value,t=n.subject;t.next(e),t.complete()}function Te(n,e,t){if(e)if(V(e))t=e;else return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return Te(n,t).apply(void 0,r).pipe(R(function(o){return N(o)?e.apply(void 0,o):e(o)}))};return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o={subject:void 0,args:r,callbackFunc:n,scheduler:t,context:this};return new m(function(s){var u=o.context,c=o.subject;if(t)return t.schedule(Bn,0,{params:o,subscriber:s,context:u});if(!c){c=o.subject=new et;var h=function(){for(var p=[],f=0;f<arguments.length;f++)p[f]=arguments[f];var a=p.shift();if(a){c.error(a);return}c.next(p.length<=1?p[0]:p),c.complete()};try{n.apply(u,r.concat([h]))}catch(p){kt(c)?c.error(p):console.warn(p)}}return c.subscribe(s)})}}function Bn(n){var e=this,t=n.params,r=n.subscriber,i=n.context,o=t.callbackFunc,s=t.args,u=t.scheduler,c=t.subject;if(!c){c=t.subject=new et;var h=function(){for(var p=[],f=0;f<arguments.length;f++)p[f]=arguments[f];var a=p.shift();if(a)e.add(u.schedule(Ce,0,{err:a,subject:c}));else{var w=p.length<=1?p[0]:p;e.add(u.schedule(Un,0,{value:w,subject:c}))}};try{o.apply(i,s.concat([h]))}catch(p){this.add(u.schedule(Ce,0,{err:p,subject:c}))}}this.add(c.subscribe(r))}function Un(n){var e=n.value,t=n.subject;t.next(e),t.complete()}function Ce(n){var e=n.err,t=n.subject;t.error(e)}var $=function(n){l(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.notifyNext=function(t,r,i,o,s){this.destination.next(r)},e.prototype.notifyError=function(t,r){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(b),zn=function(n){l(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parent=t,o.outerValue=r,o.outerIndex=i,o.index=0,o}return e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(b),Ln=function(n){return function(e){return n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,J),e}};function qn(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Y=qn(),Yn=function(n){return function(e){var t=n[Y]();do{var r=void 0;try{r=t.next()}catch(i){return e.error(i),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}while(!0);return typeof t.return=="function"&&e.add(function(){t.return&&t.return()}),e}},Gn=function(n){return function(e){var t=n[Z]();if(typeof t.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)}},Oe=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function Ie(n){return!!n&&typeof n.subscribe!="function"&&typeof n.then=="function"}var at=function(n){if(!!n&&typeof n[Z]=="function")return Gn(n);if(Oe(n))return de(n);if(Ie(n))return Ln(n);if(!!n&&typeof n[Y]=="function")return Yn(n);var e=Vt(n)?"an invalid object":"'"+n+"'",t="You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(t)};function P(n,e,t,r,i){if(i===void 0&&(i=new zn(n,t,r)),!i.closed)return e instanceof m?e.subscribe(i):at(e)(i)}var Ne={};function $n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=void 0,r=void 0;return V(n[n.length-1])&&(r=n.pop()),typeof n[n.length-1]=="function"&&(t=n.pop()),n.length===1&&N(n[0])&&(n=n[0]),ut(n,r).lift(new zt(t))}var zt=function(){function n(e){this.resultSelector=e}return n.prototype.call=function(e,t){return t.subscribe(new Hn(e,this.resultSelector))},n}(),Hn=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.resultSelector=r,i.active=0,i.values=[],i.observables=[],i}return e.prototype._next=function(t){this.values.push(Ne),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,r=t.length;if(r===0)this.destination.complete();else{this.active=r,this.toRespond=r;for(var i=0;i<r;i++){var o=t[i];this.add(P(this,o,void 0,i))}}},e.prototype.notifyComplete=function(t){(this.active-=1)===0&&this.destination.complete()},e.prototype.notifyNext=function(t,r,i){var o=this.values,s=o[i],u=this.toRespond?s===Ne?--this.toRespond:this.toRespond:0;o[i]=r,u===0&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},e.prototype._tryResultSelector=function(t){var r;try{r=this.resultSelector.apply(this,t)}catch(i){this.destination.error(i);return}this.destination.next(r)},e}($);function Qn(n,e){return new m(function(t){var r=new g;return r.add(e.schedule(function(){var i=n[Z]();r.add(i.subscribe({next:function(o){r.add(e.schedule(function(){return t.next(o)}))},error:function(o){r.add(e.schedule(function(){return t.error(o)}))},complete:function(){r.add(e.schedule(function(){return t.complete()}))}}))})),r})}function Kn(n,e){return new m(function(t){var r=new g;return r.add(e.schedule(function(){return n.then(function(i){r.add(e.schedule(function(){t.next(i),r.add(e.schedule(function(){return t.complete()}))}))},function(i){r.add(e.schedule(function(){return t.error(i)}))})})),r})}function Jn(n,e){if(!n)throw new Error("Iterable cannot be null");return new m(function(t){var r=new g,i;return r.add(function(){i&&typeof i.return=="function"&&i.return()}),r.add(e.schedule(function(){i=n[Y](),r.add(e.schedule(function(){if(!t.closed){var o,s;try{var u=i.next();o=u.value,s=u.done}catch(c){t.error(c);return}s?t.complete():(t.next(o),this.schedule())}}))})),r})}function Zn(n){return n&&typeof n[Z]=="function"}function Xn(n){return n&&typeof n[Y]=="function"}function Ae(n,e){if(n!=null){if(Zn(n))return Qn(n,e);if(Ie(n))return Kn(n,e);if(Oe(n))return Mt(n,e);if(Xn(n)||typeof n=="string")return Jn(n,e)}throw new TypeError((n!==null&&typeof n||n)+" is not observable")}function D(n,e){return e?Ae(n,e):n instanceof m?n:new m(at(n))}var x=function(n){l(e,n);function e(t){var r=n.call(this)||this;return r.parent=t,r}return e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(b),_=function(n){l(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(b);function E(n,e){if(!e.closed)return n instanceof m?n.subscribe(e):at(n)(e)}function H(n,e,t){return t===void 0&&(t=Number.POSITIVE_INFINITY),typeof e=="function"?function(r){return r.pipe(H(function(i,o){return D(n(i,o)).pipe(R(function(s,u){return e(i,s,o,u)}))},t))}:(typeof e=="number"&&(t=e),function(r){return r.lift(new tr(n,t))})}var tr=function(){function n(e,t){t===void 0&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return n.prototype.call=function(e,t){return t.subscribe(new er(e,this.project,this.concurrent))},n}(),er=function(n){l(e,n);function e(t,r,i){i===void 0&&(i=Number.POSITIVE_INFINITY);var o=n.call(this,t)||this;return o.project=r,o.concurrent=i,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var r,i=this.index++;try{r=this.project(t,i)}catch(o){this.destination.error(o);return}this.active++,this._innerSub(r)},e.prototype._innerSub=function(t){var r=new x(this),i=this.destination;i.add(r);var o=E(t,r);o!==r&&i.add(o)},e.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},e}(_),nr=H;function Lt(n){return n===void 0&&(n=Number.POSITIVE_INFINITY),H(L,n)}function Ve(){return Lt(1)}function ft(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Ve()(wt.apply(void 0,n))}function qt(n){return new m(function(e){var t;try{t=n()}catch(i){e.error(i);return}var r=t?D(t):tt();return r.subscribe(e)})}function rr(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length===1){var t=n[0];if(N(t))return gt(t,null);if(Vt(t)&&Object.getPrototypeOf(t)===Object.prototype){var r=Object.keys(t);return gt(r.map(function(o){return t[o]}),r)}}if(typeof n[n.length-1]=="function"){var i=n.pop();return n=n.length===1&&N(n[0])?n[0]:n,gt(n,null).pipe(R(function(o){return i.apply(void 0,o)}))}return gt(n,null)}function gt(n,e){return new m(function(t){var r=n.length;if(r===0){t.complete();return}for(var i=new Array(r),o=0,s=0,u=function(h){var p=D(n[h]),f=!1;t.add(p.subscribe({next:function(a){f||(f=!0,s++),i[h]=a},error:function(a){return t.error(a)},complete:function(){o++,(o===r||!f)&&(s===r&&t.next(e?e.reduce(function(a,w,S){return a[w]=i[S],a},{}):i),t.complete())}}))},c=0;c<r;c++)u(c)})}function ke(n,e,t,r){return K(t)&&(r=t,t=void 0),r?ke(n,e,t).pipe(R(function(i){return N(i)?r.apply(void 0,i):r(i)})):new m(function(i){function o(s){arguments.length>1?i.next(Array.prototype.slice.call(arguments)):i.next(s)}je(n,e,o,i,t)})}function je(n,e,t,r,i){var o;if(sr(n)){var s=n;n.addEventListener(e,t,i),o=function(){return s.removeEventListener(e,t,i)}}else if(or(n)){var u=n;n.on(e,t),o=function(){return u.off(e,t)}}else if(ir(n)){var c=n;n.addListener(e,t),o=function(){return c.removeListener(e,t)}}else if(n&&n.length)for(var h=0,p=n.length;h<p;h++)je(n[h],e,t,r,i);else throw new TypeError("Invalid event target");r.add(o)}function ir(n){return n&&typeof n.addListener=="function"&&typeof n.removeListener=="function"}function or(n){return n&&typeof n.on=="function"&&typeof n.off=="function"}function sr(n){return n&&typeof n.addEventListener=="function"&&typeof n.removeEventListener=="function"}function Re(n,e,t){return t?Re(n,e).pipe(R(function(r){return N(r)?t.apply(void 0,r):t(r)})):new m(function(r){var i=function(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];return r.next(s.length===1?s[0]:s)},o;try{o=n(i)}catch(s){r.error(s);return}if(!!K(e))return function(){return e(i,o)}})}function ur(n,e,t,r,i){var o,s;if(arguments.length==1){var u=n;s=u.initialState,e=u.condition,t=u.iterate,o=u.resultSelector||L,i=u.scheduler}else r===void 0||V(r)?(s=n,o=L,i=r):(s=n,o=r);return new m(function(c){var h=s;if(i)return i.schedule(cr,0,{subscriber:c,iterate:t,condition:e,resultSelector:o,state:h});do{if(e){var p=void 0;try{p=e(h)}catch(a){c.error(a);return}if(!p){c.complete();break}}var f=void 0;try{f=o(h)}catch(a){c.error(a);return}if(c.next(f),c.closed)break;try{h=t(h)}catch(a){c.error(a);return}}while(!0)})}function cr(n){var e=n.subscriber,t=n.condition;if(!e.closed){if(n.needIterate)try{n.state=n.iterate(n.state)}catch(o){e.error(o);return}else n.needIterate=!0;if(t){var r=void 0;try{r=t(n.state)}catch(o){e.error(o);return}if(!r){e.complete();return}if(e.closed)return}var i;try{i=n.resultSelector(n.state)}catch(o){e.error(o);return}if(!e.closed&&(e.next(i),!e.closed))return this.schedule(n)}}function ar(n,e,t){return e===void 0&&(e=X),t===void 0&&(t=X),qt(function(){return n()?e:t})}function rt(n){return!N(n)&&n-parseFloat(n)+1>=0}function fr(n,e){return n===void 0&&(n=0),e===void 0&&(e=A),(!rt(n)||n<0)&&(n=0),(!e||typeof e.schedule!="function")&&(e=A),new m(function(t){return t.add(e.schedule(hr,n,{subscriber:t,counter:0,period:n})),t})}function hr(n){var e=n.subscriber,t=n.counter,r=n.period;e.next(t),this.schedule({subscriber:e,counter:t+1,period:r},r)}function We(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=Number.POSITIVE_INFINITY,r=null,i=n[n.length-1];return V(i)?(r=n.pop(),n.length>1&&typeof n[n.length-1]=="number"&&(t=n.pop())):typeof i=="number"&&(t=n.pop()),r===null&&n.length===1&&n[0]instanceof m?n[0]:Lt(t)(ut(n,r))}var Fe=new m(W);function lr(){return Fe}function Yt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length===0)return X;var t=n[0],r=n.slice(1);return n.length===1&&N(t)?Yt.apply(void 0,t):new m(function(i){var o=function(){return i.add(Yt.apply(void 0,r).subscribe(i))};return D(t).subscribe({next:function(s){i.next(s)},error:o,complete:o})})}function pr(n,e){return e?new m(function(t){var r=Object.keys(n),i=new g;return i.add(e.schedule(br,0,{keys:r,index:0,subscriber:t,subscription:i,obj:n})),i}):new m(function(t){for(var r=Object.keys(n),i=0;i<r.length&&!t.closed;i++){var o=r[i];n.hasOwnProperty(o)&&t.next([o,n[o]])}t.complete()})}function br(n){var e=n.keys,t=n.index,r=n.subscriber,i=n.subscription,o=n.obj;if(!r.closed)if(t<e.length){var s=e[t];r.next([s,o[s]]),i.add(this.schedule({keys:e,index:t+1,subscriber:r,subscription:i,obj:o}))}else r.complete()}function Me(n,e){function t(){return!t.pred.apply(t.thisArg,arguments)}return t.pred=n,t.thisArg=e,t}function G(n,e){return function(r){return r.lift(new dr(n,e))}}var dr=function(){function n(e,t){this.predicate=e,this.thisArg=t}return n.prototype.call=function(e,t){return t.subscribe(new vr(e,this.predicate,this.thisArg))},n}(),vr=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.predicate=r,o.thisArg=i,o.count=0,o}return e.prototype._next=function(t){var r;try{r=this.predicate.call(this.thisArg,t,this.count++)}catch(i){this.destination.error(i);return}r&&this.destination.next(t)},e}(b);function yr(n,e,t){return[G(e,t)(new m(at(n))),G(Me(e,t))(new m(at(n)))]}function Pe(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length===1)if(N(n[0]))n=n[0];else return n[0];return ut(n,void 0).lift(new mr)}var mr=function(){function n(){}return n.prototype.call=function(e,t){return t.subscribe(new wr(e))},n}(),wr=function(n){l(e,n);function e(t){var r=n.call(this,t)||this;return r.hasFirst=!1,r.observables=[],r.subscriptions=[],r}return e.prototype._next=function(t){this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,r=t.length;if(r===0)this.destination.complete();else{for(var i=0;i<r&&!this.hasFirst;i++){var o=t[i],s=P(this,o,void 0,i);this.subscriptions&&this.subscriptions.push(s),this.add(s)}this.observables=null}},e.prototype.notifyNext=function(t,r,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==i){var s=this.subscriptions[o];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(r)},e}($);function Sr(n,e,t){return n===void 0&&(n=0),new m(function(r){e===void 0&&(e=n,n=0);var i=0,o=n;if(t)return t.schedule(gr,0,{index:i,count:e,start:n,subscriber:r});do{if(i++>=e){r.complete();break}if(r.next(o++),r.closed)break}while(!0)})}function gr(n){var e=n.start,t=n.index,r=n.count,i=n.subscriber;if(t>=r){i.complete();return}i.next(e),!i.closed&&(n.index=t+1,n.start=e+1,this.schedule(n))}function De(n,e,t){n===void 0&&(n=0);var r=-1;return rt(e)?r=Number(e)<1&&1||Number(e):V(e)&&(t=e),V(t)||(t=A),new m(function(i){var o=rt(n)?n:+n-t.now();return t.schedule(xr,o,{index:0,period:r,subscriber:i})})}function xr(n){var e=n.index,t=n.period,r=n.subscriber;if(r.next(e),!r.closed){if(t===-1)return r.complete();n.index=e+1,this.schedule(n,t)}}function _r(n,e){return new m(function(t){var r;try{r=n()}catch(u){t.error(u);return}var i;try{i=e(r)}catch(u){t.error(u);return}var o=i?D(i):X,s=o.subscribe(t);return function(){s.unsubscribe(),r&&r.unsubscribe()}})}function Be(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n[n.length-1];return typeof t=="function"&&n.pop(),ut(n,void 0).lift(new Ue(t))}var Ue=function(){function n(e){this.resultSelector=e}return n.prototype.call=function(e,t){return t.subscribe(new Er(e,this.resultSelector))},n}(),Er=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.resultSelector=r,o.iterators=[],o.active=0,o.resultSelector=typeof r=="function"?r:void 0,o}return e.prototype._next=function(t){var r=this.iterators;N(t)?r.push(new Cr(t)):typeof t[Y]=="function"?r.push(new Tr(t[Y]())):r.push(new Or(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,r=t.length;if(this.unsubscribe(),r===0){this.destination.complete();return}this.active=r;for(var i=0;i<r;i++){var o=t[i];if(o.stillUnsubscribed){var s=this.destination;s.add(o.subscribe())}else this.active--}},e.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,r=t.length,i=this.destination,o=0;o<r;o++){var s=t[o];if(typeof s.hasValue=="function"&&!s.hasValue())return}for(var u=!1,c=[],o=0;o<r;o++){var s=t[o],h=s.next();if(s.hasCompleted()&&(u=!0),h.done){i.complete();return}c.push(h.value)}this.resultSelector?this._tryresultSelector(c):i.next(c),u&&i.complete()},e.prototype._tryresultSelector=function(t){var r;try{r=this.resultSelector.apply(this,t)}catch(i){this.destination.error(i);return}this.destination.next(r)},e}(b),Tr=function(){function n(e){this.iterator=e,this.nextResult=e.next()}return n.prototype.hasValue=function(){return!0},n.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},n.prototype.hasCompleted=function(){var e=this.nextResult;return Boolean(e&&e.done)},n}(),Cr=function(){function n(e){this.array=e,this.index=0,this.length=0,this.length=e.length}return n.prototype[Y]=function(){return this},n.prototype.next=function(e){var t=this.index++,r=this.array;return t<this.length?{value:r[t],done:!1}:{value:null,done:!0}},n.prototype.hasValue=function(){return this.array.length>this.index},n.prototype.hasCompleted=function(){return this.array.length===this.index},n}(),Or=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.parent=r,o.observable=i,o.stillUnsubscribed=!0,o.buffer=[],o.isComplete=!1,o}return e.prototype[Y]=function(){return this},e.prototype.next=function(){var t=this.buffer;return t.length===0&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t){this.buffer.push(t),this.parent.checkIterators()},e.prototype.subscribe=function(){return E(this.observable,new x(this))},e}(_),F=Object.freeze({__proto__:null,Observable:m,ConnectableObservable:he,GroupedObservable:Wt,observable:Z,Subject:C,BehaviorSubject:le,ReplaySubject:Bt,AsyncSubject:et,asap:St,asapScheduler:we,async:A,asyncScheduler:Se,queue:be,queueScheduler:pe,animationFrame:An,animationFrameScheduler:ge,VirtualTimeScheduler:Vn,VirtualAction:xe,Scheduler:Ft,Subscription:g,Subscriber:b,Notification:M,get NotificationKind(){return Dt},pipe:jt,noop:W,identity:L,isObservable:kn,ArgumentOutOfRangeError:nt,EmptyError:ct,ObjectUnsubscribedError:q,UnsubscriptionError:it,TimeoutError:_e,bindCallback:Ee,bindNodeCallback:Te,combineLatest:$n,concat:ft,defer:qt,empty:tt,forkJoin:rr,from:D,fromEvent:ke,fromEventPattern:Re,generate:ur,iif:ar,interval:fr,merge:We,never:lr,of:wt,onErrorResumeNext:Yt,pairs:pr,partition:yr,race:Pe,range:Sr,throwError:Pt,timer:De,using:_r,zip:Be,scheduled:Ae,EMPTY:X,NEVER:Fe,config:j});function ze(n){return function(t){return t.lift(new Ir(n))}}var Ir=function(){function n(e){this.durationSelector=e}return n.prototype.call=function(e,t){return t.subscribe(new Nr(e,this.durationSelector))},n}(),Nr=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.durationSelector=r,i.hasValue=!1,i}return e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var r=void 0;try{var i=this.durationSelector;r=i(t)}catch(s){return this.destination.error(s)}var o=E(r,new x(this));!o||o.closed?this.clearThrottle():this.add(this.throttled=o)}},e.prototype.clearThrottle=function(){var t=this,r=t.value,i=t.hasValue,o=t.throttled;o&&(this.remove(o),this.throttled=void 0,o.unsubscribe()),i&&(this.value=void 0,this.hasValue=!1,this.destination.next(r))},e.prototype.notifyNext=function(){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(_);function Ar(n,e){return e===void 0&&(e=A),ze(function(){return De(n,e)})}function Vr(n){return function(t){return t.lift(new kr(n))}}var kr=function(){function n(e){this.closingNotifier=e}return n.prototype.call=function(e,t){return t.subscribe(new jr(e,this.closingNotifier))},n}(),jr=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.buffer=[],i.add(E(r,new x(i))),i}return e.prototype._next=function(t){this.buffer.push(t)},e.prototype.notifyNext=function(){var t=this.buffer;this.buffer=[],this.destination.next(t)},e}(_);function Rr(n,e){return e===void 0&&(e=null),function(r){return r.lift(new Wr(n,e))}}var Wr=function(){function n(e,t){this.bufferSize=e,this.startBufferEvery=t,!t||e===t?this.subscriberClass=Fr:this.subscriberClass=Mr}return n.prototype.call=function(e,t){return t.subscribe(new this.subscriberClass(e,this.bufferSize,this.startBufferEvery))},n}(),Fr=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.bufferSize=r,i.buffer=[],i}return e.prototype._next=function(t){var r=this.buffer;r.push(t),r.length==this.bufferSize&&(this.destination.next(r),this.buffer=[])},e.prototype._complete=function(){var t=this.buffer;t.length>0&&this.destination.next(t),n.prototype._complete.call(this)},e}(b),Mr=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.bufferSize=r,o.startBufferEvery=i,o.buffers=[],o.count=0,o}return e.prototype._next=function(t){var r=this,i=r.bufferSize,o=r.startBufferEvery,s=r.buffers,u=r.count;this.count++,u%o==0&&s.push([]);for(var c=s.length;c--;){var h=s[c];h.push(t),h.length===i&&(s.splice(c,1),this.destination.next(h))}},e.prototype._complete=function(){for(var t=this,r=t.buffers,i=t.destination;r.length>0;){var o=r.shift();o.length>0&&i.next(o)}n.prototype._complete.call(this)},e}(b);function Pr(n){var e=arguments.length,t=A;V(arguments[arguments.length-1])&&(t=arguments[arguments.length-1],e--);var r=null;e>=2&&(r=arguments[1]);var i=Number.POSITIVE_INFINITY;return e>=3&&(i=arguments[2]),function(s){return s.lift(new Dr(n,r,i,t))}}var Dr=function(){function n(e,t,r,i){this.bufferTimeSpan=e,this.bufferCreationInterval=t,this.maxBufferSize=r,this.scheduler=i}return n.prototype.call=function(e,t){return t.subscribe(new Ur(e,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},n}(),Br=function(){function n(){this.buffer=[]}return n}(),Ur=function(n){l(e,n);function e(t,r,i,o,s){var u=n.call(this,t)||this;u.bufferTimeSpan=r,u.bufferCreationInterval=i,u.maxBufferSize=o,u.scheduler=s,u.contexts=[];var c=u.openContext();if(u.timespanOnly=i==null||i<0,u.timespanOnly){var h={subscriber:u,context:c,bufferTimeSpan:r};u.add(c.closeAction=s.schedule(Le,r,h))}else{var p={subscriber:u,context:c},f={bufferTimeSpan:r,bufferCreationInterval:i,subscriber:u,scheduler:s};u.add(c.closeAction=s.schedule(qe,r,p)),u.add(s.schedule(zr,i,f))}return u}return e.prototype._next=function(t){for(var r=this.contexts,i=r.length,o,s=0;s<i;s++){var u=r[s],c=u.buffer;c.push(t),c.length==this.maxBufferSize&&(o=u)}o&&this.onBufferFull(o)},e.prototype._error=function(t){this.contexts.length=0,n.prototype._error.call(this,t)},e.prototype._complete=function(){for(var t=this,r=t.contexts,i=t.destination;r.length>0;){var o=r.shift();i.next(o.buffer)}n.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.contexts=null},e.prototype.onBufferFull=function(t){this.closeContext(t);var r=t.closeAction;if(r.unsubscribe(),this.remove(r),!this.closed&&this.timespanOnly){t=this.openContext();var i=this.bufferTimeSpan,o={subscriber:this,context:t,bufferTimeSpan:i};this.add(t.closeAction=this.scheduler.schedule(Le,i,o))}},e.prototype.openContext=function(){var t=new Br;return this.contexts.push(t),t},e.prototype.closeContext=function(t){this.destination.next(t.buffer);var r=this.contexts,i=r?r.indexOf(t):-1;i>=0&&r.splice(r.indexOf(t),1)},e}(b);function Le(n){var e=n.subscriber,t=n.context;t&&e.closeContext(t),e.closed||(n.context=e.openContext(),n.context.closeAction=this.schedule(n,n.bufferTimeSpan))}function zr(n){var e=n.bufferCreationInterval,t=n.bufferTimeSpan,r=n.subscriber,i=n.scheduler,o=r.openContext(),s=this;r.closed||(r.add(o.closeAction=i.schedule(qe,t,{subscriber:r,context:o})),s.schedule(n,e))}function qe(n){var e=n.subscriber,t=n.context;e.closeContext(t)}function Lr(n,e){return function(r){return r.lift(new qr(n,e))}}var qr=function(){function n(e,t){this.openings=e,this.closingSelector=t}return n.prototype.call=function(e,t){return t.subscribe(new Yr(e,this.openings,this.closingSelector))},n}(),Yr=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.closingSelector=i,o.contexts=[],o.add(P(o,r)),o}return e.prototype._next=function(t){for(var r=this.contexts,i=r.length,o=0;o<i;o++)r[o].buffer.push(t)},e.prototype._error=function(t){for(var r=this.contexts;r.length>0;){var i=r.shift();i.subscription.unsubscribe(),i.buffer=null,i.subscription=null}this.contexts=null,n.prototype._error.call(this,t)},e.prototype._complete=function(){for(var t=this.contexts;t.length>0;){var r=t.shift();this.destination.next(r.buffer),r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,n.prototype._complete.call(this)},e.prototype.notifyNext=function(t,r){t?this.closeBuffer(t):this.openBuffer(r)},e.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},e.prototype.openBuffer=function(t){try{var r=this.closingSelector,i=r.call(this,t);i&&this.trySubscribe(i)}catch(o){this._error(o)}},e.prototype.closeBuffer=function(t){var r=this.contexts;if(r&&t){var i=t.buffer,o=t.subscription;this.destination.next(i),r.splice(r.indexOf(t),1),this.remove(o),o.unsubscribe()}},e.prototype.trySubscribe=function(t){var r=this.contexts,i=[],o=new g,s={buffer:i,subscription:o};r.push(s);var u=P(this,t,s);!u||u.closed?this.closeBuffer(s):(u.context=s,this.add(u),o.add(u))},e}($);function Gr(n){return function(e){return e.lift(new $r(n))}}var $r=function(){function n(e){this.closingSelector=e}return n.prototype.call=function(e,t){return t.subscribe(new Hr(e,this.closingSelector))},n}(),Hr=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.closingSelector=r,i.subscribing=!1,i.openBuffer(),i}return e.prototype._next=function(t){this.buffer.push(t)},e.prototype._complete=function(){var t=this.buffer;t&&this.destination.next(t),n.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},e.prototype.notifyNext=function(){this.openBuffer()},e.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},e.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var r=this.buffer;this.buffer&&this.destination.next(r),this.buffer=[];var i;try{var o=this.closingSelector;i=o()}catch(s){return this.error(s)}t=new g,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add(E(i,new x(this))),this.subscribing=!1},e}(_);function Qr(n){return function(t){var r=new Kr(n),i=t.lift(r);return r.caught=i}}var Kr=function(){function n(e){this.selector=e}return n.prototype.call=function(e,t){return t.subscribe(new Jr(e,this.selector,this.caught))},n}(),Jr=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.selector=r,o.caught=i,o}return e.prototype.error=function(t){if(!this.isStopped){var r=void 0;try{r=this.selector(t,this.caught)}catch(s){n.prototype.error.call(this,s);return}this._unsubscribeAndRecycle();var i=new x(this);this.add(i);var o=E(r,i);o!==i&&this.add(o)}},e}(_);function Zr(n){return function(e){return e.lift(new zt(n))}}function Xr(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=null;return typeof n[n.length-1]=="function"&&(t=n.pop()),n.length===1&&N(n[0])&&(n=n[0].slice()),function(r){return r.lift.call(D([r].concat(n)),new zt(t))}}function ti(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(t){return t.lift.call(ft.apply(void 0,[t].concat(n)))}}function Ye(n,e){return H(n,e,1)}function ei(n,e){return Ye(function(){return n},e)}function ni(n){return function(e){return e.lift(new ri(n,e))}}var ri=function(){function n(e,t){this.predicate=e,this.source=t}return n.prototype.call=function(e,t){return t.subscribe(new ii(e,this.predicate,this.source))},n}(),ii=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.predicate=r,o.source=i,o.count=0,o.index=0,o}return e.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},e.prototype._tryPredicate=function(t){var r;try{r=this.predicate(t,this.index++,this.source)}catch(i){this.destination.error(i);return}r&&this.count++},e.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},e}(b);function oi(n){return function(e){return e.lift(new si(n))}}var si=function(){function n(e){this.durationSelector=e}return n.prototype.call=function(e,t){return t.subscribe(new ui(e,this.durationSelector))},n}(),ui=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.durationSelector=r,i.hasValue=!1,i}return e.prototype._next=function(t){try{var r=this.durationSelector.call(this,t);r&&this._tryNext(t,r)}catch(i){this.destination.error(i)}},e.prototype._complete=function(){this.emitValue(),this.destination.complete()},e.prototype._tryNext=function(t,r){var i=this.durationSubscription;this.value=t,this.hasValue=!0,i&&(i.unsubscribe(),this.remove(i)),i=E(r,new x(this)),i&&!i.closed&&this.add(this.durationSubscription=i)},e.prototype.notifyNext=function(){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){if(this.hasValue){var t=this.value,r=this.durationSubscription;r&&(this.durationSubscription=void 0,r.unsubscribe(),this.remove(r)),this.value=void 0,this.hasValue=!1,n.prototype._next.call(this,t)}},e}(_);function ci(n,e){return e===void 0&&(e=A),function(t){return t.lift(new ai(n,e))}}var ai=function(){function n(e,t){this.dueTime=e,this.scheduler=t}return n.prototype.call=function(e,t){return t.subscribe(new fi(e,this.dueTime,this.scheduler))},n}(),fi=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.dueTime=r,o.scheduler=i,o.debouncedSubscription=null,o.lastValue=null,o.hasValue=!1,o}return e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(hi,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;t!==null&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(b);function hi(n){n.debouncedNext()}function ht(n){return n===void 0&&(n=null),function(e){return e.lift(new li(n))}}var li=function(){function n(e){this.defaultValue=e}return n.prototype.call=function(e,t){return t.subscribe(new pi(e,this.defaultValue))},n}(),pi=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.defaultValue=r,i.isEmpty=!0,i}return e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(b);function Ge(n){return n instanceof Date&&!isNaN(+n)}function bi(n,e){e===void 0&&(e=A);var t=Ge(n),r=t?+n-e.now():Math.abs(n);return function(i){return i.lift(new di(r,e))}}var di=function(){function n(e,t){this.delay=e,this.scheduler=t}return n.prototype.call=function(e,t){return t.subscribe(new vi(e,this.delay,this.scheduler))},n}(),vi=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.delay=r,o.scheduler=i,o.queue=[],o.active=!1,o.errored=!1,o}return e.dispatch=function(t){for(var r=t.source,i=r.queue,o=t.scheduler,s=t.destination;i.length>0&&i[0].time-o.now()<=0;)i.shift().notification.observe(s);if(i.length>0){var u=Math.max(0,i[0].time-o.now());this.schedule(t,u)}else this.unsubscribe(),r.active=!1},e.prototype._schedule=function(t){this.active=!0;var r=this.destination;r.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(this.errored!==!0){var r=this.scheduler,i=new yi(r.now()+this.delay,t);this.queue.push(i),this.active===!1&&this._schedule(r)}},e.prototype._next=function(t){this.scheduleNotification(M.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(M.createComplete()),this.unsubscribe()},e}(b),yi=function(){function n(e,t){this.time=e,this.notification=t}return n}();function mi(n,e){return e?function(t){return new Si(t,e).lift(new $e(n))}:function(t){return t.lift(new $e(n))}}var $e=function(){function n(e){this.delayDurationSelector=e}return n.prototype.call=function(e,t){return t.subscribe(new wi(e,this.delayDurationSelector))},n}(),wi=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.delayDurationSelector=r,i.completed=!1,i.delayNotifierSubscriptions=[],i.index=0,i}return e.prototype.notifyNext=function(t,r,i,o,s){this.destination.next(t),this.removeSubscription(s),this.tryComplete()},e.prototype.notifyError=function(t,r){this._error(t)},e.prototype.notifyComplete=function(t){var r=this.removeSubscription(t);r&&this.destination.next(r),this.tryComplete()},e.prototype._next=function(t){var r=this.index++;try{var i=this.delayDurationSelector(t,r);i&&this.tryDelay(i,t)}catch(o){this.destination.error(o)}},e.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},e.prototype.removeSubscription=function(t){t.unsubscribe();var r=this.delayNotifierSubscriptions.indexOf(t);return r!==-1&&this.delayNotifierSubscriptions.splice(r,1),t.outerValue},e.prototype.tryDelay=function(t,r){var i=P(this,t,r);if(i&&!i.closed){var o=this.destination;o.add(i),this.delayNotifierSubscriptions.push(i)}},e.prototype.tryComplete=function(){this.completed&&this.delayNotifierSubscriptions.length===0&&this.destination.complete()},e}($),Si=function(n){l(e,n);function e(t,r){var i=n.call(this)||this;return i.source=t,i.subscriptionDelay=r,i}return e.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new gi(t,this.source))},e}(m),gi=function(n){l(e,n);function e(t,r){var i=n.call(this)||this;return i.parent=t,i.source=r,i.sourceSubscribed=!1,i}return e.prototype._next=function(t){this.subscribeToSource()},e.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},e.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},e.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},e}(b);function xi(){return function(e){return e.lift(new _i)}}var _i=function(){function n(){}return n.prototype.call=function(e,t){return t.subscribe(new Ei(e))},n}(),Ei=function(n){l(e,n);function e(t){return n.call(this,t)||this}return e.prototype._next=function(t){t.observe(this.destination)},e}(b);function Ti(n,e){return function(t){return t.lift(new Ci(n,e))}}var Ci=function(){function n(e,t){this.keySelector=e,this.flushes=t}return n.prototype.call=function(e,t){return t.subscribe(new Oi(e,this.keySelector,this.flushes))},n}(),Oi=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.keySelector=r,o.values=new Set,i&&o.add(E(i,new x(o))),o}return e.prototype.notifyNext=function(){this.values.clear()},e.prototype.notifyError=function(t){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var r,i=this.destination;try{r=this.keySelector(t)}catch(o){i.error(o);return}this._finalizeNext(r,t)},e.prototype._finalizeNext=function(t,r){var i=this.values;i.has(t)||(i.add(t),this.destination.next(r))},e}(_);function He(n,e){return function(t){return t.lift(new Ii(n,e))}}var Ii=function(){function n(e,t){this.compare=e,this.keySelector=t}return n.prototype.call=function(e,t){return t.subscribe(new Ni(e,this.compare,this.keySelector))},n}(),Ni=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.keySelector=i,o.hasKey=!1,typeof r=="function"&&(o.compare=r),o}return e.prototype.compare=function(t,r){return t===r},e.prototype._next=function(t){var r;try{var i=this.keySelector;r=i?i(t):t}catch(u){return this.destination.error(u)}var o=!1;if(this.hasKey)try{var s=this.compare;o=s(this.key,r)}catch(u){return this.destination.error(u)}else this.hasKey=!0;o||(this.key=r,this.destination.next(t))},e}(b);function Ai(n,e){return He(function(t,r){return e?e(t[n],r[n]):t[n]===r[n]})}function xt(n){return n===void 0&&(n=ji),function(e){return e.lift(new Vi(n))}}var Vi=function(){function n(e){this.errorFactory=e}return n.prototype.call=function(e,t){return t.subscribe(new ki(e,this.errorFactory))},n}(),ki=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.errorFactory=r,i.hasValue=!1,i}return e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(r){t=r}this.destination.error(t)},e}(b);function ji(){return new ct}function Gt(n){return function(e){return n===0?tt():e.lift(new Ri(n))}}var Ri=function(){function n(e){if(this.total=e,this.total<0)throw new nt}return n.prototype.call=function(e,t){return t.subscribe(new Wi(e,this.total))},n}(),Wi=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.total=r,i.count=0,i}return e.prototype._next=function(t){var r=this.total,i=++this.count;i<=r&&(this.destination.next(t),i===r&&(this.destination.complete(),this.unsubscribe()))},e}(b);function Fi(n,e){if(n<0)throw new nt;var t=arguments.length>=2;return function(r){return r.pipe(G(function(i,o){return o===n}),Gt(1),t?ht(e):xt(function(){return new nt}))}}function Mi(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(t){return ft(t,wt.apply(void 0,n))}}function Pi(n,e){return function(t){return t.lift(new Di(n,e,t))}}var Di=function(){function n(e,t,r){this.predicate=e,this.thisArg=t,this.source=r}return n.prototype.call=function(e,t){return t.subscribe(new Bi(e,this.predicate,this.thisArg,this.source))},n}(),Bi=function(n){l(e,n);function e(t,r,i,o){var s=n.call(this,t)||this;return s.predicate=r,s.thisArg=i,s.source=o,s.index=0,s.thisArg=i||s,s}return e.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},e.prototype._next=function(t){var r=!1;try{r=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(i){this.destination.error(i);return}r||this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(b);function Ui(){return function(n){return n.lift(new zi)}}var zi=function(){function n(){}return n.prototype.call=function(e,t){return t.subscribe(new Li(e))},n}(),Li=function(n){l(e,n);function e(t){var r=n.call(this,t)||this;return r.hasCompleted=!1,r.hasSubscription=!1,r}return e.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add(E(t,new x(this))))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(_);function Qe(n,e){return e?function(t){return t.pipe(Qe(function(r,i){return D(n(r,i)).pipe(R(function(o,s){return e(r,o,i,s)}))}))}:function(t){return t.lift(new qi(n))}}var qi=function(){function n(e){this.project=e}return n.prototype.call=function(e,t){return t.subscribe(new Yi(e,this.project))},n}(),Yi=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.project=r,i.hasSubscription=!1,i.hasCompleted=!1,i.index=0,i}return e.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},e.prototype.tryNext=function(t){var r,i=this.index++;try{r=this.project(t,i)}catch(o){this.destination.error(o);return}this.hasSubscription=!0,this._innerSub(r)},e.prototype._innerSub=function(t){var r=new x(this),i=this.destination;i.add(r);var o=E(t,r);o!==r&&i.add(o)},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(_);function Gi(n,e,t){return e===void 0&&(e=Number.POSITIVE_INFINITY),e=(e||0)<1?Number.POSITIVE_INFINITY:e,function(r){return r.lift(new $i(n,e,t))}}var $i=function(){function n(e,t,r){this.project=e,this.concurrent=t,this.scheduler=r}return n.prototype.call=function(e,t){return t.subscribe(new Hi(e,this.project,this.concurrent,this.scheduler))},n}(),Hi=function(n){l(e,n);function e(t,r,i,o){var s=n.call(this,t)||this;return s.project=r,s.concurrent=i,s.scheduler=o,s.index=0,s.active=0,s.hasCompleted=!1,i<Number.POSITIVE_INFINITY&&(s.buffer=[]),s}return e.dispatch=function(t){var r=t.subscriber,i=t.result,o=t.value,s=t.index;r.subscribeToProjection(i,o,s)},e.prototype._next=function(t){var r=this.destination;if(r.closed){this._complete();return}var i=this.index++;if(this.active<this.concurrent){r.next(t);try{var o=this.project,s=o(t,i);if(!this.scheduler)this.subscribeToProjection(s,t,i);else{var u={subscriber:this,result:s,value:t,index:i},c=this.destination;c.add(this.scheduler.schedule(e.dispatch,0,u))}}catch(h){r.error(h)}}else this.buffer.push(t)},e.prototype.subscribeToProjection=function(t,r,i){this.active++;var o=this.destination;o.add(E(t,new x(this)))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&this.active===0&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this._next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t&&t.length>0&&this._next(t.shift()),this.hasCompleted&&this.active===0&&this.destination.complete()},e}(_);function Qi(n){return function(e){return e.lift(new Ki(n))}}var Ki=function(){function n(e){this.callback=e}return n.prototype.call=function(e,t){return t.subscribe(new Ji(e,this.callback))},n}(),Ji=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.add(new g(r)),i}return e}(b);function Zi(n,e){if(typeof n!="function")throw new TypeError("predicate is not a function");return function(t){return t.lift(new Ke(n,t,!1,e))}}var Ke=function(){function n(e,t,r,i){this.predicate=e,this.source=t,this.yieldIndex=r,this.thisArg=i}return n.prototype.call=function(e,t){return t.subscribe(new Xi(e,this.predicate,this.source,this.yieldIndex,this.thisArg))},n}(),Xi=function(n){l(e,n);function e(t,r,i,o,s){var u=n.call(this,t)||this;return u.predicate=r,u.source=i,u.yieldIndex=o,u.thisArg=s,u.index=0,u}return e.prototype.notifyComplete=function(t){var r=this.destination;r.next(t),r.complete(),this.unsubscribe()},e.prototype._next=function(t){var r=this,i=r.predicate,o=r.thisArg,s=this.index++;try{var u=i.call(o||this,t,s,this.source);u&&this.notifyComplete(this.yieldIndex?s:t)}catch(c){this.destination.error(c)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(b);function to(n,e){return function(t){return t.lift(new Ke(n,t,!0,e))}}function eo(n,e){var t=arguments.length>=2;return function(r){return r.pipe(n?G(function(i,o){return n(i,o,r)}):L,Gt(1),t?ht(e):xt(function(){return new ct}))}}function no(){return function(e){return e.lift(new ro)}}var ro=function(){function n(){}return n.prototype.call=function(e,t){return t.subscribe(new io(e))},n}(),io=function(n){l(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype._next=function(t){},e}(b);function oo(){return function(n){return n.lift(new so)}}var so=function(){function n(){}return n.prototype.call=function(e,t){return t.subscribe(new uo(e))},n}(),uo=function(n){l(e,n);function e(t){return n.call(this,t)||this}return e.prototype.notifyComplete=function(t){var r=this.destination;r.next(t),r.complete()},e.prototype._next=function(t){this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(b);function _t(n){return function(t){return n===0?tt():t.lift(new co(n))}}var co=function(){function n(e){if(this.total=e,this.total<0)throw new nt}return n.prototype.call=function(e,t){return t.subscribe(new ao(e,this.total))},n}(),ao=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.total=r,i.ring=new Array,i.count=0,i}return e.prototype._next=function(t){var r=this.ring,i=this.total,o=this.count++;if(r.length<i)r.push(t);else{var s=o%i;r[s]=t}},e.prototype._complete=function(){var t=this.destination,r=this.count;if(r>0)for(var i=this.count>=this.total?this.total:this.count,o=this.ring,s=0;s<i;s++){var u=r++%i;t.next(o[u])}t.complete()},e}(b);function fo(n,e){var t=arguments.length>=2;return function(r){return r.pipe(n?G(function(i,o){return n(i,o,r)}):L,_t(1),t?ht(e):xt(function(){return new ct}))}}function ho(n){return function(e){return e.lift(new lo(n))}}var lo=function(){function n(e){this.value=e}return n.prototype.call=function(e,t){return t.subscribe(new po(e,this.value))},n}(),po=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.value=r,i}return e.prototype._next=function(t){this.destination.next(this.value)},e}(b);function bo(){return function(e){return e.lift(new vo)}}var vo=function(){function n(){}return n.prototype.call=function(e,t){return t.subscribe(new yo(e))},n}(),yo=function(n){l(e,n);function e(t){return n.call(this,t)||this}return e.prototype._next=function(t){this.destination.next(M.createNext(t))},e.prototype._error=function(t){var r=this.destination;r.next(M.createError(t)),r.complete()},e.prototype._complete=function(){var t=this.destination;t.next(M.createComplete()),t.complete()},e}(b);function Et(n,e){var t=!1;return arguments.length>=2&&(t=!0),function(i){return i.lift(new mo(n,e,t))}}var mo=function(){function n(e,t,r){r===void 0&&(r=!1),this.accumulator=e,this.seed=t,this.hasSeed=r}return n.prototype.call=function(e,t){return t.subscribe(new wo(e,this.accumulator,this.seed,this.hasSeed))},n}(),wo=function(n){l(e,n);function e(t,r,i,o){var s=n.call(this,t)||this;return s.accumulator=r,s._seed=i,s.hasSeed=o,s.index=0,s}return Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(!this.hasSeed)this.seed=t,this.destination.next(t);else return this._tryNext(t)},e.prototype._tryNext=function(t){var r=this.index++,i;try{i=this.accumulator(this.seed,t,r)}catch(o){this.destination.error(o)}this.seed=i,this.destination.next(i)},e}(b);function Tt(n,e){return arguments.length>=2?function(r){return jt(Et(n,e),_t(1),ht(e))(r)}:function(r){return jt(Et(function(i,o,s){return n(i,o,s+1)}),_t(1))(r)}}function So(n){var e=typeof n=="function"?function(t,r){return n(t,r)>0?t:r}:function(t,r){return t>r?t:r};return Tt(e)}function go(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(t){return t.lift.call(We.apply(void 0,[t].concat(n)))}}function xo(n,e,t){return t===void 0&&(t=Number.POSITIVE_INFINITY),typeof e=="function"?H(function(){return n},e,t):(typeof e=="number"&&(t=e),H(function(){return n},t))}function _o(n,e,t){return t===void 0&&(t=Number.POSITIVE_INFINITY),function(r){return r.lift(new Eo(n,e,t))}}var Eo=function(){function n(e,t,r){this.accumulator=e,this.seed=t,this.concurrent=r}return n.prototype.call=function(e,t){return t.subscribe(new To(e,this.accumulator,this.seed,this.concurrent))},n}(),To=function(n){l(e,n);function e(t,r,i,o){var s=n.call(this,t)||this;return s.accumulator=r,s.acc=i,s.concurrent=o,s.hasValue=!1,s.hasCompleted=!1,s.buffer=[],s.active=0,s.index=0,s}return e.prototype._next=function(t){if(this.active<this.concurrent){var r=this.index++,i=this.destination,o=void 0;try{var s=this.accumulator;o=s(this.acc,t,r)}catch(u){return i.error(u)}this.active++,this._innerSub(o)}else this.buffer.push(t)},e.prototype._innerSub=function(t){var r=new x(this),i=this.destination;i.add(r);var o=E(t,r);o!==r&&i.add(o)},e.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&(this.hasValue===!1&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},e.prototype.notifyNext=function(t){var r=this.destination;this.acc=t,this.hasValue=!0,r.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):this.active===0&&this.hasCompleted&&(this.hasValue===!1&&this.destination.next(this.acc),this.destination.complete())},e}(_);function Co(n){var e=typeof n=="function"?function(t,r){return n(t,r)<0?t:r}:function(t,r){return t<r?t:r};return Tt(e)}function Q(n,e){return function(r){var i;if(typeof n=="function"?i=n:i=function(){return n},typeof e=="function")return r.lift(new Oo(i,e));var o=Object.create(r,cn);return o.source=r,o.subjectFactory=i,o}}var Oo=function(){function n(e,t){this.subjectFactory=e,this.selector=t}return n.prototype.call=function(e,t){var r=this.selector,i=this.subjectFactory(),o=r(i).subscribe(e);return o.add(t.subscribe(i)),o},n}();function Io(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.length===1&&N(n[0])&&(n=n[0]),function(t){return t.lift(new No(n))}}var No=function(){function n(e){this.nextSources=e}return n.prototype.call=function(e,t){return t.subscribe(new Ao(e,this.nextSources))},n}(),Ao=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.destination=t,i.nextSources=r,i}return e.prototype.notifyError=function(){this.subscribeToNextSource()},e.prototype.notifyComplete=function(){this.subscribeToNextSource()},e.prototype._error=function(t){this.subscribeToNextSource(),this.unsubscribe()},e.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},e.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();if(t){var r=new x(this),i=this.destination;i.add(r);var o=E(t,r);o!==r&&i.add(o)}else this.destination.complete()},e}(_);function Vo(){return function(n){return n.lift(new ko)}}var ko=function(){function n(){}return n.prototype.call=function(e,t){return t.subscribe(new jo(e))},n}(),jo=function(n){l(e,n);function e(t){var r=n.call(this,t)||this;return r.hasPrev=!1,r}return e.prototype._next=function(t){var r;this.hasPrev?r=[this.prev,t]:this.hasPrev=!0,this.prev=t,r&&this.destination.next(r)},e}(b);function Ro(n,e){return function(t){return[G(n,e)(t),G(Me(n,e))(t)]}}function Wo(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.length;if(t===0)throw new Error("list of properties cannot be empty.");return function(r){return R(Fo(n,t))(r)}}function Fo(n,e){var t=function(r){for(var i=r,o=0;o<e;o++){var s=i!=null?i[n[o]]:void 0;if(s!==void 0)i=s;else return}return i};return t}function Mo(n){return n?Q(function(){return new C},n):Q(new C)}function Po(n){return function(e){return Q(new le(n))(e)}}function Do(){return function(n){return Q(new et)(n)}}function Bo(n,e,t,r){t&&typeof t!="function"&&(r=t);var i=typeof t=="function"?t:void 0,o=new Bt(n,e,r);return function(s){return Q(function(){return o},i)(s)}}function Uo(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(r){return n.length===1&&N(n[0])&&(n=n[0]),r.lift.call(Pe.apply(void 0,[r].concat(n)))}}function zo(n){return n===void 0&&(n=-1),function(e){return n===0?tt():n<0?e.lift(new Je(-1,e)):e.lift(new Je(n-1,e))}}var Je=function(){function n(e,t){this.count=e,this.source=t}return n.prototype.call=function(e,t){return t.subscribe(new Lo(e,this.count,this.source))},n}(),Lo=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.count=r,o.source=i,o}return e.prototype.complete=function(){if(!this.isStopped){var t=this,r=t.source,i=t.count;if(i===0)return n.prototype.complete.call(this);i>-1&&(this.count=i-1),r.subscribe(this._unsubscribeAndRecycle())}},e}(b);function qo(n){return function(e){return e.lift(new Yo(n))}}var Yo=function(){function n(e){this.notifier=e}return n.prototype.call=function(e,t){return t.subscribe(new Go(e,this.notifier,t))},n}(),Go=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.notifier=r,o.source=i,o.sourceIsBeingSubscribedTo=!0,o}return e.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},e.prototype.notifyComplete=function(){if(this.sourceIsBeingSubscribedTo===!1)return n.prototype.complete.call(this)},e.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return n.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},e.prototype._unsubscribe=function(){var t=this,r=t.notifications,i=t.retriesSubscription;r&&(r.unsubscribe(),this.notifications=void 0),i&&(i.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype._unsubscribeAndRecycle=function(){var t=this._unsubscribe;return this._unsubscribe=null,n.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=t,this},e.prototype.subscribeToRetries=function(){this.notifications=new C;var t;try{var r=this.notifier;t=r(this.notifications)}catch(i){return n.prototype.complete.call(this)}this.retries=t,this.retriesSubscription=E(t,new x(this))},e}(_);function $o(n){return n===void 0&&(n=-1),function(e){return e.lift(new Ho(n,e))}}var Ho=function(){function n(e,t){this.count=e,this.source=t}return n.prototype.call=function(e,t){return t.subscribe(new Qo(e,this.count,this.source))},n}(),Qo=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.count=r,o.source=i,o}return e.prototype.error=function(t){if(!this.isStopped){var r=this,i=r.source,o=r.count;if(o===0)return n.prototype.error.call(this,t);o>-1&&(this.count=o-1),i.subscribe(this._unsubscribeAndRecycle())}},e}(b);function Ko(n){return function(e){return e.lift(new Jo(n,e))}}var Jo=function(){function n(e,t){this.notifier=e,this.source=t}return n.prototype.call=function(e,t){return t.subscribe(new Zo(e,this.notifier,this.source))},n}(),Zo=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.notifier=r,o.source=i,o}return e.prototype.error=function(t){if(!this.isStopped){var r=this.errors,i=this.retries,o=this.retriesSubscription;if(i)this.errors=void 0,this.retriesSubscription=void 0;else{r=new C;try{var s=this.notifier;i=s(r)}catch(u){return n.prototype.error.call(this,u)}o=E(i,new x(this))}this._unsubscribeAndRecycle(),this.errors=r,this.retries=i,this.retriesSubscription=o,r.next(t)}},e.prototype._unsubscribe=function(){var t=this,r=t.errors,i=t.retriesSubscription;r&&(r.unsubscribe(),this.errors=void 0),i&&(i.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype.notifyNext=function(){var t=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=t,this.source.subscribe(this)},e}(_);function Xo(n){return function(e){return e.lift(new ts(n))}}var ts=function(){function n(e){this.notifier=e}return n.prototype.call=function(e,t){var r=new es(e),i=t.subscribe(r);return i.add(E(this.notifier,new x(r))),i},n}(),es=function(n){l(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.hasValue=!1,t}return e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},e}(_);function ns(n,e){return e===void 0&&(e=A),function(t){return t.lift(new rs(n,e))}}var rs=function(){function n(e,t){this.period=e,this.scheduler=t}return n.prototype.call=function(e,t){return t.subscribe(new is(e,this.period,this.scheduler))},n}(),is=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.period=r,o.scheduler=i,o.hasValue=!1,o.add(i.schedule(os,r,{subscriber:o,period:r})),o}return e.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},e}(b);function os(n){var e=n.subscriber,t=n.period;e.notifyNext(),this.schedule(n,t)}function ss(n,e){return function(t){return t.lift(new us(n,e))}}var us=function(){function n(e,t){this.compareTo=e,this.comparator=t}return n.prototype.call=function(e,t){return t.subscribe(new cs(e,this.compareTo,this.comparator))},n}(),cs=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.compareTo=r,o.comparator=i,o._a=[],o._b=[],o._oneComplete=!1,o.destination.add(r.subscribe(new as(t,o))),o}return e.prototype._next=function(t){this._oneComplete&&this._b.length===0?this.emit(!1):(this._a.push(t),this.checkValues())},e.prototype._complete=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=!0,this.unsubscribe()},e.prototype.checkValues=function(){for(var t=this,r=t._a,i=t._b,o=t.comparator;r.length>0&&i.length>0;){var s=r.shift(),u=i.shift(),c=!1;try{c=o?o(s,u):s===u}catch(h){this.destination.error(h)}c||this.emit(!1)}},e.prototype.emit=function(t){var r=this.destination;r.next(t),r.complete()},e.prototype.nextB=function(t){this._oneComplete&&this._a.length===0?this.emit(!1):(this._b.push(t),this.checkValues())},e.prototype.completeB=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=!0},e}(b),as=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.parent=r,i}return e.prototype._next=function(t){this.parent.nextB(t)},e.prototype._error=function(t){this.parent.error(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},e}(b);function fs(){return new C}function hs(){return function(n){return Rt()(Q(fs)(n))}}function ls(n,e,t){var r;return n&&typeof n=="object"?r=n:r={bufferSize:n,windowTime:e,refCount:!1,scheduler:t},function(i){return i.lift(ps(r))}}function ps(n){var e=n.bufferSize,t=e===void 0?Number.POSITIVE_INFINITY:e,r=n.windowTime,i=r===void 0?Number.POSITIVE_INFINITY:r,o=n.refCount,s=n.scheduler,u,c=0,h,p=!1,f=!1;return function(w){c++;var S;!u||p?(p=!1,u=new Bt(t,i,s),S=u.subscribe(this),h=w.subscribe({next:function(v){u.next(v)},error:function(v){p=!0,u.error(v)},complete:function(){f=!0,h=void 0,u.complete()}})):S=u.subscribe(this),this.add(function(){c--,S.unsubscribe(),h&&!f&&o&&c===0&&(h.unsubscribe(),h=void 0,u=void 0)})}}function bs(n){return function(e){return e.lift(new ds(n,e))}}var ds=function(){function n(e,t){this.predicate=e,this.source=t}return n.prototype.call=function(e,t){return t.subscribe(new vs(e,this.predicate,this.source))},n}(),vs=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.predicate=r,o.source=i,o.seenValue=!1,o.index=0,o}return e.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},e.prototype._next=function(t){var r=this.index++;this.predicate?this.tryNext(t,r):this.applySingleValue(t)},e.prototype.tryNext=function(t,r){try{this.predicate(t,r,this.source)&&this.applySingleValue(t)}catch(i){this.destination.error(i)}},e.prototype._complete=function(){var t=this.destination;this.index>0?(t.next(this.seenValue?this.singleValue:void 0),t.complete()):t.error(new ct)},e}(b);function ys(n){return function(e){return e.lift(new ms(n))}}var ms=function(){function n(e){this.total=e}return n.prototype.call=function(e,t){return t.subscribe(new ws(e,this.total))},n}(),ws=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.total=r,i.count=0,i}return e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(b);function Ss(n){return function(e){return e.lift(new gs(n))}}var gs=function(){function n(e){if(this._skipCount=e,this._skipCount<0)throw new nt}return n.prototype.call=function(e,t){return this._skipCount===0?t.subscribe(new b(e)):t.subscribe(new xs(e,this._skipCount))},n}(),xs=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i._skipCount=r,i._count=0,i._ring=new Array(r),i}return e.prototype._next=function(t){var r=this._skipCount,i=this._count++;if(i<r)this._ring[i]=t;else{var o=i%r,s=this._ring,u=s[o];s[o]=t,this.destination.next(u)}},e}(b);function _s(n){return function(e){return e.lift(new Es(n))}}var Es=function(){function n(e){this.notifier=e}return n.prototype.call=function(e,t){return t.subscribe(new Ts(e,this.notifier))},n}(),Ts=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;i.hasValue=!1;var o=new x(i);i.add(o),i.innerSubscription=o;var s=E(r,o);return s!==o&&(i.add(s),i.innerSubscription=s),i}return e.prototype._next=function(t){this.hasValue&&n.prototype._next.call(this,t)},e.prototype.notifyNext=function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},e.prototype.notifyComplete=function(){},e}(_);function Cs(n){return function(e){return e.lift(new Os(n))}}var Os=function(){function n(e){this.predicate=e}return n.prototype.call=function(e,t){return t.subscribe(new Is(e,this.predicate))},n}(),Is=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.predicate=r,i.skipping=!0,i.index=0,i}return e.prototype._next=function(t){var r=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||r.next(t)},e.prototype.tryCallPredicate=function(t){try{var r=this.predicate(t,this.index++);this.skipping=Boolean(r)}catch(i){this.destination.error(i)}},e}(b);function Ns(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n[n.length-1];return V(t)?(n.pop(),function(r){return ft(n,r,t)}):function(r){return ft(n,r)}}var As=function(n){l(e,n);function e(t,r,i){r===void 0&&(r=0),i===void 0&&(i=St);var o=n.call(this)||this;return o.source=t,o.delayTime=r,o.scheduler=i,(!rt(r)||r<0)&&(o.delayTime=0),(!i||typeof i.schedule!="function")&&(o.scheduler=St),o}return e.create=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=St),new e(t,r,i)},e.dispatch=function(t){var r=t.source,i=t.subscriber;return this.add(r.subscribe(i))},e.prototype._subscribe=function(t){var r=this.delayTime,i=this.source,o=this.scheduler;return o.schedule(e.dispatch,r,{source:i,subscriber:t})},e}(m);function Vs(n,e){return e===void 0&&(e=0),function(r){return r.lift(new ks(n,e))}}var ks=function(){function n(e,t){this.scheduler=e,this.delay=t}return n.prototype.call=function(e,t){return new As(t,this.delay,this.scheduler).subscribe(e)},n}();function lt(n,e){return typeof e=="function"?function(t){return t.pipe(lt(function(r,i){return D(n(r,i)).pipe(R(function(o,s){return e(r,o,i,s)}))}))}:function(t){return t.lift(new js(n))}}var js=function(){function n(e){this.project=e}return n.prototype.call=function(e,t){return t.subscribe(new Rs(e,this.project))},n}(),Rs=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.project=r,i.index=0,i}return e.prototype._next=function(t){var r,i=this.index++;try{r=this.project(t,i)}catch(o){this.destination.error(o);return}this._innerSub(r)},e.prototype._innerSub=function(t){var r=this.innerSubscription;r&&r.unsubscribe();var i=new x(this),o=this.destination;o.add(i),this.innerSubscription=E(t,i),this.innerSubscription!==i&&o.add(this.innerSubscription)},e.prototype._complete=function(){var t=this.innerSubscription;(!t||t.closed)&&n.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&n.prototype._complete.call(this)},e.prototype.notifyNext=function(t){this.destination.next(t)},e}(_);function Ws(){return lt(L)}function Fs(n,e){return e?lt(function(){return n},e):lt(function(){return n})}function Ms(n){return function(e){return e.lift(new Ps(n))}}var Ps=function(){function n(e){this.notifier=e}return n.prototype.call=function(e,t){var r=new Ds(e),i=E(this.notifier,new x(r));return i&&!r.seenValue?(r.add(i),t.subscribe(r)):r},n}(),Ds=function(n){l(e,n);function e(t){var r=n.call(this,t)||this;return r.seenValue=!1,r}return e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(_);function Bs(n,e){return e===void 0&&(e=!1),function(t){return t.lift(new Us(n,e))}}var Us=function(){function n(e,t){this.predicate=e,this.inclusive=t}return n.prototype.call=function(e,t){return t.subscribe(new zs(e,this.predicate,this.inclusive))},n}(),zs=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.predicate=r,o.inclusive=i,o.index=0,o}return e.prototype._next=function(t){var r=this.destination,i;try{i=this.predicate(t,this.index++)}catch(o){r.error(o);return}this.nextOrComplete(t,i)},e.prototype.nextOrComplete=function(t,r){var i=this.destination;Boolean(r)?i.next(t):(this.inclusive&&i.next(t),i.complete())},e}(b);function Ls(n,e,t){return function(i){return i.lift(new qs(n,e,t))}}var qs=function(){function n(e,t,r){this.nextOrObserver=e,this.error=t,this.complete=r}return n.prototype.call=function(e,t){return t.subscribe(new Ys(e,this.nextOrObserver,this.error,this.complete))},n}(),Ys=function(n){l(e,n);function e(t,r,i,o){var s=n.call(this,t)||this;return s._tapNext=W,s._tapError=W,s._tapComplete=W,s._tapError=i||W,s._tapComplete=o||W,K(r)?(s._context=s,s._tapNext=r):r&&(s._context=r,s._tapNext=r.next||W,s._tapError=r.error||W,s._tapComplete=r.complete||W),s}return e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(r){this.destination.error(r);return}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(r){this.destination.error(r);return}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){this.destination.error(t);return}return this.destination.complete()},e}(b),Ze={leading:!0,trailing:!1};function Gs(n,e){return e===void 0&&(e=Ze),function(t){return t.lift(new $s(n,!!e.leading,!!e.trailing))}}var $s=function(){function n(e,t,r){this.durationSelector=e,this.leading=t,this.trailing=r}return n.prototype.call=function(e,t){return t.subscribe(new Hs(e,this.durationSelector,this.leading,this.trailing))},n}(),Hs=function(n){l(e,n);function e(t,r,i,o){var s=n.call(this,t)||this;return s.destination=t,s.durationSelector=r,s._leading=i,s._trailing=o,s._hasValue=!1,s}return e.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},e.prototype.send=function(){var t=this,r=t._hasValue,i=t._sendValue;r&&(this.destination.next(i),this.throttle(i)),this._hasValue=!1,this._sendValue=void 0},e.prototype.throttle=function(t){var r=this.tryDurationSelector(t);r&&this.add(this._throttled=E(r,new x(this)))},e.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(r){return this.destination.error(r),null}},e.prototype.throttlingDone=function(){var t=this,r=t._throttled,i=t._trailing;r&&r.unsubscribe(),this._throttled=void 0,i&&this.send()},e.prototype.notifyNext=function(){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()},e}(_);function Qs(n,e,t){return e===void 0&&(e=A),t===void 0&&(t=Ze),function(r){return r.lift(new Ks(n,e,t.leading,t.trailing))}}var Ks=function(){function n(e,t,r,i){this.duration=e,this.scheduler=t,this.leading=r,this.trailing=i}return n.prototype.call=function(e,t){return t.subscribe(new Js(e,this.duration,this.scheduler,this.leading,this.trailing))},n}(),Js=function(n){l(e,n);function e(t,r,i,o,s){var u=n.call(this,t)||this;return u.duration=r,u.scheduler=i,u.leading=o,u.trailing=s,u._hasTrailingValue=!1,u._trailingValue=null,u}return e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Zs,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(b);function Zs(n){var e=n.subscriber;e.clearThrottle()}function Xs(n){return n===void 0&&(n=A),function(e){return qt(function(){return e.pipe(Et(function(t,r){var i=t.current;return{value:r,current:n.now(),last:i}},{current:n.now(),value:void 0,last:void 0}),R(function(t){var r=t.current,i=t.last,o=t.value;return new tu(o,r-i)}))})}}var tu=function(){function n(e,t){this.value=e,this.interval=t}return n}();function Xe(n,e,t){return t===void 0&&(t=A),function(r){var i=Ge(n),o=i?+n-t.now():Math.abs(n);return r.lift(new eu(o,i,e,t))}}var eu=function(){function n(e,t,r,i){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=r,this.scheduler=i}return n.prototype.call=function(e,t){return t.subscribe(new nu(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},n}(),nu=function(n){l(e,n);function e(t,r,i,o,s){var u=n.call(this,t)||this;return u.absoluteTimeout=r,u.waitFor=i,u.withObservable=o,u.scheduler=s,u.scheduleTimeout(),u}return e.dispatchTimeout=function(t){var r=t.withObservable;t._unsubscribeAndRecycle(),t.add(E(r,new x(t)))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),n.prototype._next.call(this,t)},e.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},e}(_);function ru(n,e){return e===void 0&&(e=A),Xe(n,Pt(new _e),e)}function iu(n){return n===void 0&&(n=A),R(function(e){return new ou(e,n.now())})}var ou=function(){function n(e,t){this.value=e,this.timestamp=t}return n}();function su(n,e,t){return t===0?[e]:(n.push(e),n)}function uu(){return Tt(su,[])}function cu(n){return function(t){return t.lift(new au(n))}}var au=function(){function n(e){this.windowBoundaries=e}return n.prototype.call=function(e,t){var r=new fu(e),i=t.subscribe(r);return i.closed||r.add(E(this.windowBoundaries,new x(r))),i},n}(),fu=function(n){l(e,n);function e(t){var r=n.call(this,t)||this;return r.window=new C,t.next(r.window),r}return e.prototype.notifyNext=function(){this.openWindow()},e.prototype.notifyError=function(t){this._error(t)},e.prototype.notifyComplete=function(){this._complete()},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t)},e.prototype._complete=function(){this.window.complete(),this.destination.complete()},e.prototype._unsubscribe=function(){this.window=null},e.prototype.openWindow=function(){var t=this.window;t&&t.complete();var r=this.destination,i=this.window=new C;r.next(i)},e}(_);function hu(n,e){return e===void 0&&(e=0),function(r){return r.lift(new lu(n,e))}}var lu=function(){function n(e,t){this.windowSize=e,this.startWindowEvery=t}return n.prototype.call=function(e,t){return t.subscribe(new pu(e,this.windowSize,this.startWindowEvery))},n}(),pu=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.destination=t,o.windowSize=r,o.startWindowEvery=i,o.windows=[new C],o.count=0,t.next(o.windows[0]),o}return e.prototype._next=function(t){for(var r=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,i=this.destination,o=this.windowSize,s=this.windows,u=s.length,c=0;c<u&&!this.closed;c++)s[c].next(t);var h=this.count-o+1;if(h>=0&&h%r==0&&!this.closed&&s.shift().complete(),++this.count%r==0&&!this.closed){var p=new C;s.push(p),i.next(p)}},e.prototype._error=function(t){var r=this.windows;if(r)for(;r.length>0&&!this.closed;)r.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},e.prototype._unsubscribe=function(){this.count=0,this.windows=null},e}(b);function bu(n){var e=A,t=null,r=Number.POSITIVE_INFINITY;return V(arguments[3])&&(e=arguments[3]),V(arguments[2])?e=arguments[2]:rt(arguments[2])&&(r=Number(arguments[2])),V(arguments[1])?e=arguments[1]:rt(arguments[1])&&(t=Number(arguments[1])),function(o){return o.lift(new du(n,t,r,e))}}var du=function(){function n(e,t,r,i){this.windowTimeSpan=e,this.windowCreationInterval=t,this.maxWindowSize=r,this.scheduler=i}return n.prototype.call=function(e,t){return t.subscribe(new yu(e,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},n}(),vu=function(n){l(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._numberOfNextedValues=0,t}return e.prototype.next=function(t){this._numberOfNextedValues++,n.prototype.next.call(this,t)},Object.defineProperty(e.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),e}(C),yu=function(n){l(e,n);function e(t,r,i,o,s){var u=n.call(this,t)||this;u.destination=t,u.windowTimeSpan=r,u.windowCreationInterval=i,u.maxWindowSize=o,u.scheduler=s,u.windows=[];var c=u.openWindow();if(i!==null&&i>=0){var h={subscriber:u,window:c,context:null},p={windowTimeSpan:r,windowCreationInterval:i,subscriber:u,scheduler:s};u.add(s.schedule(tn,r,h)),u.add(s.schedule(wu,i,p))}else{var f={subscriber:u,window:c,windowTimeSpan:r};u.add(s.schedule(mu,r,f))}return u}return e.prototype._next=function(t){for(var r=this.windows,i=r.length,o=0;o<i;o++){var s=r[o];s.closed||(s.next(t),s.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(s))}},e.prototype._error=function(t){for(var r=this.windows;r.length>0;)r.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){for(var t=this.windows;t.length>0;){var r=t.shift();r.closed||r.complete()}this.destination.complete()},e.prototype.openWindow=function(){var t=new vu;this.windows.push(t);var r=this.destination;return r.next(t),t},e.prototype.closeWindow=function(t){t.complete();var r=this.windows;r.splice(r.indexOf(t),1)},e}(b);function mu(n){var e=n.subscriber,t=n.windowTimeSpan,r=n.window;r&&e.closeWindow(r),n.window=e.openWindow(),this.schedule(n,t)}function wu(n){var e=n.windowTimeSpan,t=n.subscriber,r=n.scheduler,i=n.windowCreationInterval,o=t.openWindow(),s=this,u={action:s,subscription:null},c={subscriber:t,window:o,context:u};u.subscription=r.schedule(tn,e,c),s.add(u.subscription),s.schedule(n,i)}function tn(n){var e=n.subscriber,t=n.window,r=n.context;r&&r.action&&r.subscription&&r.action.remove(r.subscription),e.closeWindow(t)}function Su(n,e){return function(t){return t.lift(new gu(n,e))}}var gu=function(){function n(e,t){this.openings=e,this.closingSelector=t}return n.prototype.call=function(e,t){return t.subscribe(new xu(e,this.openings,this.closingSelector))},n}(),xu=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.openings=r,o.closingSelector=i,o.contexts=[],o.add(o.openSubscription=P(o,r,r)),o}return e.prototype._next=function(t){var r=this.contexts;if(r)for(var i=r.length,o=0;o<i;o++)r[o].window.next(t)},e.prototype._error=function(t){var r=this.contexts;if(this.contexts=null,r)for(var i=r.length,o=-1;++o<i;){var s=r[o];s.window.error(t),s.subscription.unsubscribe()}n.prototype._error.call(this,t)},e.prototype._complete=function(){var t=this.contexts;if(this.contexts=null,t)for(var r=t.length,i=-1;++i<r;){var o=t[i];o.window.complete(),o.subscription.unsubscribe()}n.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var r=t.length,i=-1;++i<r;){var o=t[i];o.window.unsubscribe(),o.subscription.unsubscribe()}},e.prototype.notifyNext=function(t,r,i,o,s){if(t===this.openings){var u=void 0;try{var c=this.closingSelector;u=c(r)}catch(w){return this.error(w)}var h=new C,p=new g,f={window:h,subscription:p};this.contexts.push(f);var a=P(this,u,f);a.closed?this.closeWindow(this.contexts.length-1):(a.context=f,p.add(a)),this.destination.next(h)}else this.closeWindow(this.contexts.indexOf(t))},e.prototype.notifyError=function(t){this.error(t)},e.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},e.prototype.closeWindow=function(t){if(t!==-1){var r=this.contexts,i=r[t],o=i.window,s=i.subscription;r.splice(t,1),o.complete(),s.unsubscribe()}},e}($);function _u(n){return function(t){return t.lift(new Eu(n))}}var Eu=function(){function n(e){this.closingSelector=e}return n.prototype.call=function(e,t){return t.subscribe(new Tu(e,this.closingSelector))},n}(),Tu=function(n){l(e,n);function e(t,r){var i=n.call(this,t)||this;return i.destination=t,i.closingSelector=r,i.openWindow(),i}return e.prototype.notifyNext=function(t,r,i,o,s){this.openWindow(s)},e.prototype.notifyError=function(t){this._error(t)},e.prototype.notifyComplete=function(t){this.openWindow(t)},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},e.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},e.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},e.prototype.openWindow=function(t){t===void 0&&(t=null),t&&(this.remove(t),t.unsubscribe());var r=this.window;r&&r.complete();var i=this.window=new C;this.destination.next(i);var o;try{var s=this.closingSelector;o=s()}catch(u){this.destination.error(u),this.window.error(u);return}this.add(this.closingNotification=P(this,o))},e}($);function Cu(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(t){var r;typeof n[n.length-1]=="function"&&(r=n.pop());var i=n;return t.lift(new Ou(i,r))}}var Ou=function(){function n(e,t){this.observables=e,this.project=t}return n.prototype.call=function(e,t){return t.subscribe(new Iu(e,this.observables,this.project))},n}(),Iu=function(n){l(e,n);function e(t,r,i){var o=n.call(this,t)||this;o.observables=r,o.project=i,o.toRespond=[];var s=r.length;o.values=new Array(s);for(var u=0;u<s;u++)o.toRespond.push(u);for(var u=0;u<s;u++){var c=r[u];o.add(P(o,c,void 0,u))}return o}return e.prototype.notifyNext=function(t,r,i){this.values[i]=r;var o=this.toRespond;if(o.length>0){var s=o.indexOf(i);s!==-1&&o.splice(s,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(this.toRespond.length===0){var r=[t].concat(this.values);this.project?this._tryProject(r):this.destination.next(r)}},e.prototype._tryProject=function(t){var r;try{r=this.project.apply(this,t)}catch(i){this.destination.error(i);return}this.destination.next(r)},e}($);function Nu(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(r){return r.lift.call(Be.apply(void 0,[r].concat(n)))}}function Au(n){return function(e){return e.lift(new Ue(n))}}var O=Object.freeze({__proto__:null,audit:ze,auditTime:Ar,buffer:Vr,bufferCount:Rr,bufferTime:Pr,bufferToggle:Lr,bufferWhen:Gr,catchError:Qr,combineAll:Zr,combineLatest:Xr,concat:ti,concatAll:Ve,concatMap:Ye,concatMapTo:ei,count:ni,debounce:oi,debounceTime:ci,defaultIfEmpty:ht,delay:bi,delayWhen:mi,dematerialize:xi,distinct:Ti,distinctUntilChanged:He,distinctUntilKeyChanged:Ai,elementAt:Fi,endWith:Mi,every:Pi,exhaust:Ui,exhaustMap:Qe,expand:Gi,filter:G,finalize:Qi,find:Zi,findIndex:to,first:eo,groupBy:fn,ignoreElements:no,isEmpty:oo,last:fo,map:R,mapTo:ho,materialize:bo,max:So,merge:go,mergeAll:Lt,mergeMap:H,flatMap:nr,mergeMapTo:xo,mergeScan:_o,min:Co,multicast:Q,observeOn:Sn,onErrorResumeNext:Io,pairwise:Vo,partition:Ro,pluck:Wo,publish:Mo,publishBehavior:Po,publishLast:Do,publishReplay:Bo,race:Uo,reduce:Tt,repeat:zo,repeatWhen:qo,retry:$o,retryWhen:Ko,refCount:Rt,sample:Xo,sampleTime:ns,scan:Et,sequenceEqual:ss,share:hs,shareReplay:ls,single:bs,skip:ys,skipLast:Ss,skipUntil:_s,skipWhile:Cs,startWith:Ns,subscribeOn:Vs,switchAll:Ws,switchMap:lt,switchMapTo:Fs,take:Gt,takeLast:_t,takeUntil:Ms,takeWhile:Bs,tap:Ls,throttle:Gs,throttleTime:Qs,throwIfEmpty:xt,timeInterval:Xs,timeout:ru,timeoutWith:Xe,timestamp:iu,toArray:uu,window:cu,windowCount:hu,windowTime:bu,windowToggle:Su,windowWhen:_u,withLatestFrom:Cu,zip:Nu,zipAll:Au}),pt=vt(function(n,e){Object.defineProperty(e,"__esModule",{value:!0});function t(h){return h.pipe(O.concatMap(function(p){return p.split("")}),O.scan(function(p,f){return p.indexOf("}")>=0?f:p+f},""),O.filter(function(p){return p.indexOf("}")>=0}),O.map(function(p){return JSON.parse(p)}))}e.parseControl=t;function r(h){for(var p=[],f=0;f<h.length;f++)f%3==0?p.push(h[f]<<4|h[f+1]>>4):(p.push((h[f]&15)<<8|h[f+1]),f++);return p}e.decodeUnsigned12BitData=r;function i(h){return r(h).map(function(p){return .48828125*(p-2048)})}e.decodeEEGSamples=i;function o(h){return{sequenceId:h.getUint16(0),batteryLevel:h.getUint16(2)/512,fuelGaugeVoltage:h.getUint16(4)*2.2,temperature:h.getUint16(8)}}e.parseTelemetry=o;function s(h,p){function f(a){return{x:p*h.getInt16(a),y:p*h.getInt16(a+2),z:p*h.getInt16(a+4)}}return{sequenceId:h.getUint16(0),samples:[f(2),f(8),f(14)]}}function u(h){return s(h,610352e-10)}e.parseAccelerometer=u;function c(h){return s(h,.0074768)}e.parseGyroscope=c}),B=vt(function(n,e){var t=z&&z.__awaiter||function(u,c,h,p){return new(h||(h=Promise))(function(f,a){function w(d){try{v(p.next(d))}catch(T){a(T)}}function S(d){try{v(p.throw(d))}catch(T){a(T)}}function v(d){d.done?f(d.value):new h(function(T){T(d.value)}).then(w,S)}v((p=p.apply(u,c||[])).next())})},r=z&&z.__generator||function(u,c){var h={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},p,f,a,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(d){return function(T){return v([d,T])}}function v(d){if(p)throw new TypeError("Generator is already executing.");for(;h;)try{if(p=1,f&&(a=d[0]&2?f.return:d[0]?f.throw||((a=f.return)&&a.call(f),0):f.next)&&!(a=a.call(f,d[1])).done)return a;switch(f=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return h.label++,{value:d[1],done:!1};case 5:h.label++,f=d[1],d=[0];continue;case 7:d=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){h=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){h.label=d[1];break}if(d[0]===6&&h.label<a[1]){h.label=a[1],a=d;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(d);break}a[2]&&h.ops.pop(),h.trys.pop();continue}d=c.call(u,h)}catch(T){d=[6,T],f=0}finally{p=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});function i(u){return new TextDecoder().decode(u.subarray(1,1+u[0]))}e.decodeResponse=i;function o(u){var c=new TextEncoder().encode("X"+u+`
`);return c[0]=c.length-1,c}e.encodeCommand=o;function s(u){return t(this,void 0,void 0,function(){var c;return r(this,function(h){switch(h.label){case 0:return[4,u.startNotifications()];case 1:return h.sent(),c=F.fromEvent(u.service.device,"gattserverdisconnected"),[2,F.fromEvent(u,"characteristicvaluechanged").pipe(O.takeUntil(c),O.map(function(p){return p.target.value}))]}})})}e.observableCharacteristic=s}),Vu=vt(function(n,e){Object.defineProperty(e,"__esModule",{value:!0});function t(r){var i=[],o=null;return r.pipe(O.mergeMap(function(s){if(s.timestamp!==o&&(o=s.timestamp,i.length)){var u=F.from([i.slice()]);return i.splice(0,i.length,s),u}return i.push(s),F.from([])}),O.concat(F.from([i])),O.mergeMap(function(s){var u=s[0].samples.map(function(c,h){for(var p=[NaN,NaN,NaN,NaN,NaN],f=0,a=s;f<a.length;f++){var w=a[f];p[w.electrode]=w.samples[h]}return{data:p,index:s[0].index,timestamp:s[0].timestamp+h*1e3/en.EEG_FREQUENCY}});return F.from(u)}))}e.zipSamples=t}),en=vt(function(n,e){var t=z&&z.__awaiter||function(p,f,a,w){return new(a||(a=Promise))(function(S,v){function d(y){try{U(w.next(y))}catch(k){v(k)}}function T(y){try{U(w.throw(y))}catch(k){v(k)}}function U(y){y.done?S(y.value):new a(function(k){k(y.value)}).then(d,T)}U((w=w.apply(p,f||[])).next())})},r=z&&z.__generator||function(p,f){var a={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},w,S,v,d;return d={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function T(y){return function(k){return U([y,k])}}function U(y){if(w)throw new TypeError("Generator is already executing.");for(;a;)try{if(w=1,S&&(v=y[0]&2?S.return:y[0]?S.throw||((v=S.return)&&v.call(S),0):S.next)&&!(v=v.call(S,y[1])).done)return v;switch(S=0,v&&(y=[y[0]&2,v.value]),y[0]){case 0:case 1:v=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,S=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(v=a.trys,!(v=v.length>0&&v[v.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!v||y[1]>v[0]&&y[1]<v[3])){a.label=y[1];break}if(y[0]===6&&a.label<v[1]){a.label=v[1],v=y;break}if(v&&a.label<v[2]){a.label=v[2],a.ops.push(y);break}v[2]&&a.ops.pop(),a.trys.pop();continue}y=f.call(p,a)}catch(k){y=[6,k],S=0}finally{w=v=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.zipSamples=Vu.zipSamples,e.MUSE_SERVICE=65165;var i="273e0001-4c4d-454d-96be-f03bac821358",o="273e000b-4c4d-454d-96be-f03bac821358",s="273e0009-4c4d-454d-96be-f03bac821358",u="273e000a-4c4d-454d-96be-f03bac821358",c=["273e0003-4c4d-454d-96be-f03bac821358","273e0004-4c4d-454d-96be-f03bac821358","273e0005-4c4d-454d-96be-f03bac821358","273e0006-4c4d-454d-96be-f03bac821358","273e0007-4c4d-454d-96be-f03bac821358"];e.EEG_FREQUENCY=256,e.channelNames=["TP9","AF7","AF8","TP10","AUX"];var h=function(){function p(){this.enableAux=!1,this.deviceName="",this.connectionStatus=new F.BehaviorSubject(!1),this.gatt=null,this.lastIndex=null,this.lastTimestamp=null}return p.prototype.connect=function(f){return t(this,void 0,void 0,function(){var a,w,S,v,d,T,U,y,k,$t,Ht,Ct,Qt,Kt,Jt,bt,Ot=this;return r(this,function(I){switch(I.label){case 0:return f?(this.gatt=f,[3,4]):[3,1];case 1:return[4,navigator.bluetooth.requestDevice({filters:[{services:[e.MUSE_SERVICE]}]})];case 2:return a=I.sent(),w=this,[4,a.gatt.connect()];case 3:w.gatt=I.sent(),I.label=4;case 4:return this.deviceName=this.gatt.device.name||null,[4,this.gatt.getPrimaryService(e.MUSE_SERVICE)];case 5:return S=I.sent(),F.fromEvent(this.gatt.device,"gattserverdisconnected").pipe(O.first()).subscribe(function(){Ot.gatt=null,Ot.connectionStatus.next(!1)}),v=this,[4,S.getCharacteristic(i)];case 6:return v.controlChar=I.sent(),d=this,[4,B.observableCharacteristic(this.controlChar)];case 7:return d.rawControlData=I.sent().pipe(O.map(function(dt){return B.decodeResponse(new Uint8Array(dt.buffer))}),O.share()),this.controlResponses=pt.parseControl(this.rawControlData),[4,S.getCharacteristic(o)];case 8:return T=I.sent(),U=this,[4,B.observableCharacteristic(T)];case 9:return U.telemetryData=I.sent().pipe(O.map(pt.parseTelemetry)),[4,S.getCharacteristic(s)];case 10:return y=I.sent(),k=this,[4,B.observableCharacteristic(y)];case 11:return k.gyroscopeData=I.sent().pipe(O.map(pt.parseGyroscope)),[4,S.getCharacteristic(u)];case 12:return $t=I.sent(),Ht=this,[4,B.observableCharacteristic($t)];case 13:Ht.accelerometerData=I.sent().pipe(O.map(pt.parseAccelerometer)),this.eventMarkers=new F.Subject,this.eegCharacteristics=[],Ct=[],Qt=this.enableAux?c.length:4,Kt=function(dt){var Zt,It,Xt,te;return r(this,function(Nt){switch(Nt.label){case 0:return Zt=c[dt],[4,S.getCharacteristic(Zt)];case 1:return It=Nt.sent(),te=(Xt=Ct).push,[4,B.observableCharacteristic(It)];case 2:return te.apply(Xt,[Nt.sent().pipe(O.map(function(ee){var ne=ee.getUint16(0);return{electrode:dt,index:ne,samples:pt.decodeEEGSamples(new Uint8Array(ee.buffer).subarray(2)),timestamp:Ot.getTimestamp(ne)}}))]),Jt.eegCharacteristics.push(It),[2]}})},Jt=this,bt=0,I.label=14;case 14:return bt<Qt?[5,Kt(bt)]:[3,17];case 15:I.sent(),I.label=16;case 16:return bt++,[3,14];case 17:return this.eegReadings=F.merge.apply(void 0,Ct),this.connectionStatus.next(!0),[2]}})})},p.prototype.sendCommand=function(f){return t(this,void 0,void 0,function(){return r(this,function(a){switch(a.label){case 0:return[4,this.controlChar.writeValue(B.encodeCommand(f))];case 1:return a.sent(),[2]}})})},p.prototype.start=function(){return t(this,void 0,void 0,function(){var f;return r(this,function(a){switch(a.label){case 0:return[4,this.pause()];case 1:return a.sent(),f=this.enableAux?"p20":"p21",[4,this.controlChar.writeValue(B.encodeCommand(f))];case 2:return a.sent(),[4,this.controlChar.writeValue(B.encodeCommand("s"))];case 3:return a.sent(),[4,this.resume()];case 4:return a.sent(),[2]}})})},p.prototype.pause=function(){return t(this,void 0,void 0,function(){return r(this,function(f){switch(f.label){case 0:return[4,this.sendCommand("h")];case 1:return f.sent(),[2]}})})},p.prototype.resume=function(){return t(this,void 0,void 0,function(){return r(this,function(f){switch(f.label){case 0:return[4,this.sendCommand("d")];case 1:return f.sent(),[2]}})})},p.prototype.deviceInfo=function(){return t(this,void 0,void 0,function(){var f;return r(this,function(a){switch(a.label){case 0:return f=this.controlResponses.pipe(O.filter(function(w){return!!w.fw}),O.take(1)).toPromise(),[4,this.sendCommand("v1")];case 1:return a.sent(),[2,f]}})})},p.prototype.injectMarker=function(f,a){return a===void 0&&(a=new Date().getTime()),t(this,void 0,void 0,function(){return r(this,function(w){switch(w.label){case 0:return[4,this.eventMarkers.next({value:f,timestamp:a})];case 1:return w.sent(),[2]}})})},p.prototype.disconnect=function(){this.gatt&&(this.lastIndex=null,this.lastTimestamp=null,this.gatt.disconnect(),this.connectionStatus.next(!1))},p.prototype.getTimestamp=function(f){var a=12,w=1e3*(1/e.EEG_FREQUENCY)*a;for((this.lastIndex===null||this.lastTimestamp===null)&&(this.lastIndex=f,this.lastTimestamp=new Date().getTime()-w);this.lastIndex-f>4096;)f+=65536;return f===this.lastIndex?this.lastTimestamp:f>this.lastIndex?(this.lastTimestamp+=w*(f-this.lastIndex),this.lastIndex=f,this.lastTimestamp):this.lastTimestamp-w*(this.lastIndex-f)},p}();e.MuseClient=h}),ku=en.MuseClient;export{ku as MuseClient};
