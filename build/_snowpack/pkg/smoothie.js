import{c as _}from"./common/_commonjsHelpers-4f955397.js";var z=_(function(K,I){(function(C){Date.now=Date.now||function(){return new Date().getTime()};var v={extend:function(){arguments[0]=arguments[0]||{};for(var t=1;t<arguments.length;t++)for(var i in arguments[t])arguments[t].hasOwnProperty(i)&&(typeof arguments[t][i]=="object"?arguments[t][i]instanceof Array?arguments[0][i]=arguments[t][i]:arguments[0][i]=v.extend(arguments[0][i],arguments[t][i]):arguments[0][i]=arguments[t][i]);return arguments[0]},binarySearch:function(t,i){for(var a=0,n=t.length;a<n;){var e=a+n>>1;i<t[e][0]?n=e:a=e+1}return a}};function c(t){this.options=v.extend({},c.defaultOptions,t),this.disabled=!1,this.clear()}c.defaultOptions={resetBoundsInterval:3e3,resetBounds:!0},c.prototype.clear=function(){this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN},c.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var t=1;t<this.data.length;t++){var i=this.data[t][1];i>this.maxValue&&(this.maxValue=i),i<this.minValue&&(this.minValue=i)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},c.prototype.append=function(t,i,a){for(var n=this.data.length-1;n>=0&&this.data[n][0]>t;)n--;n===-1?this.data.splice(0,0,[t,i]):this.data.length>0&&this.data[n][0]===t?a?(this.data[n][1]+=i,i=this.data[n][1]):this.data[n][1]=i:n<this.data.length-1?this.data.splice(n+1,0,[t,i]):this.data.push([t,i]),this.maxValue=isNaN(this.maxValue)?i:Math.max(this.maxValue,i),this.minValue=isNaN(this.minValue)?i:Math.min(this.minValue,i)},c.prototype.dropOldData=function(t,i){for(var a=0;this.data.length-a>=i&&this.data[a+1][0]<t;)a++;a!==0&&this.data.splice(0,a)};function r(t){this.options=v.extend({},r.defaultChartOptions,t),this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0,this.lastRenderTimeMillis=0,this.lastChartTimestamp=0,this.mousemove=this.mousemove.bind(this),this.mouseout=this.mouseout.bind(this)}r.tooltipFormatter=function(t,i){for(var a=this.options.timestampFormatter||r.timeFormatter,n=[a(new Date(t))],e=0;e<i.length;++e)n.push('<span style="color:'+i[e].series.options.strokeStyle+'">'+this.options.yMaxFormatter(i[e].value,this.options.labels.precision)+"</span>");return n.join("<br>")},r.defaultChartOptions={millisPerPixel:20,enableDpiScaling:!0,yMinFormatter:function(t,i){return parseFloat(t).toFixed(i)},yMaxFormatter:function(t,i){return parseFloat(t).toFixed(i)},yIntermediateFormatter:function(t,i){return parseFloat(t).toFixed(i)},maxValueScale:1,minValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,scrollBackwards:!1,displayDataFromPercentile:1,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,sharpLines:!1,millisPerLine:1e3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2,showIntermediateLabels:!1,intermediateLabelSameAxis:!0},horizontalLines:[],tooltip:!1,tooltipLine:{lineWidth:1,strokeStyle:"#BBBBBB"},tooltipFormatter:r.tooltipFormatter,nonRealtimeData:!1,responsive:!1,limitFPS:0},r.AnimateCompatibility=function(){var t=function(a,n){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(s){return window.setTimeout(function(){s(Date.now())},16)};return e.call(window,a,n)},i=function(a){var n=window.cancelAnimationFrame||function(e){clearTimeout(e)};return n.call(window,a)};return{requestAnimationFrame:t,cancelAnimationFrame:i}}(),r.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"},r.prototype.addTimeSeries=function(t,i){this.seriesSet.push({timeSeries:t,options:v.extend({},r.defaultSeriesPresentationOptions,i)}),t.options.resetBounds&&t.options.resetBoundsInterval>0&&(t.resetBoundsTimerId=setInterval(function(){t.resetBounds()},t.options.resetBoundsInterval))},r.prototype.removeTimeSeries=function(t){for(var i=this.seriesSet.length,a=0;a<i;a++)if(this.seriesSet[a].timeSeries===t){this.seriesSet.splice(a,1);break}t.resetBoundsTimerId&&clearInterval(t.resetBoundsTimerId)},r.prototype.getTimeSeriesOptions=function(t){for(var i=this.seriesSet.length,a=0;a<i;a++)if(this.seriesSet[a].timeSeries===t)return this.seriesSet[a].options},r.prototype.bringToFront=function(t){for(var i=this.seriesSet.length,a=0;a<i;a++)if(this.seriesSet[a].timeSeries===t){var n=this.seriesSet.splice(a,1);this.seriesSet.push(n[0]);break}},r.prototype.streamTo=function(t,i){this.canvas=t,this.delay=i,this.start()},r.prototype.getTooltipEl=function(){return this.tooltipEl||(this.tooltipEl=document.createElement("div"),this.tooltipEl.className="smoothie-chart-tooltip",this.tooltipEl.style.position="absolute",this.tooltipEl.style.display="none",document.body.appendChild(this.tooltipEl)),this.tooltipEl},r.prototype.updateTooltip=function(){var t=this.getTooltipEl();if(!this.mouseover||!this.options.tooltip){t.style.display="none";return}for(var i=this.lastChartTimestamp,a=this.options.scrollBackwards?i-this.mouseX*this.options.millisPerPixel:i-(this.canvas.offsetWidth-this.mouseX)*this.options.millisPerPixel,n=[],e=0;e<this.seriesSet.length;e++){var s=this.seriesSet[e].timeSeries;if(!s.disabled){var o=v.binarySearch(s.data,a);o>0&&o<s.data.length&&n.push({series:this.seriesSet[e],index:o,value:s.data[o][1]})}}n.length?(t.innerHTML=this.options.tooltipFormatter.call(this,a,n),t.style.display="block"):t.style.display="none"},r.prototype.mousemove=function(t){this.mouseover=!0,this.mouseX=t.offsetX,this.mouseY=t.offsetY,this.mousePageX=t.pageX,this.mousePageY=t.pageY;var i=this.getTooltipEl();i.style.top=Math.round(this.mousePageY)+"px",i.style.left=Math.round(this.mousePageX)+"px",this.updateTooltip()},r.prototype.mouseout=function(){this.mouseover=!1,this.mouseX=this.mouseY=-1,this.tooltipEl&&(this.tooltipEl.style.display="none")},r.prototype.resize=function(){var t=!this.options.enableDpiScaling||!window?1:window.devicePixelRatio,i,a;this.options.responsive?(i=this.canvas.offsetWidth,a=this.canvas.offsetHeight,i!==this.lastWidth&&(this.lastWidth=i,this.canvas.setAttribute("width",Math.floor(i*t).toString()),this.canvas.getContext("2d").scale(t,t)),a!==this.lastHeight&&(this.lastHeight=a,this.canvas.setAttribute("height",Math.floor(a*t).toString()),this.canvas.getContext("2d").scale(t,t))):t!==1&&(i=parseInt(this.canvas.getAttribute("width")),a=parseInt(this.canvas.getAttribute("height")),(!this.originalWidth||Math.floor(this.originalWidth*t)!==i)&&(this.originalWidth=i,this.canvas.setAttribute("width",Math.floor(i*t).toString()),this.canvas.style.width=i+"px",this.canvas.getContext("2d").scale(t,t)),(!this.originalHeight||Math.floor(this.originalHeight*t)!==a)&&(this.originalHeight=a,this.canvas.setAttribute("height",Math.floor(a*t).toString()),this.canvas.style.height=a+"px",this.canvas.getContext("2d").scale(t,t)))},r.prototype.start=function(){if(!this.frame){this.canvas.addEventListener("mousemove",this.mousemove),this.canvas.addEventListener("mouseout",this.mouseout);var t=function(){this.frame=r.AnimateCompatibility.requestAnimationFrame(function(){if(this.options.nonRealtimeData){var i=new Date(0),a=this.seriesSet.reduce(function(n,e){var s=e.timeSeries.data,o=Math.round(this.options.displayDataFromPercentile*s.length)-1;if(o=o>=0?o:0,o=o<=s.length-1?o:s.length-1,s&&s.length>0){var u=s[o][0];n=n>u?n:u}return n}.bind(this),i);this.render(this.canvas,a>i?a:null)}else this.render();t()}.bind(this))}.bind(this);t()}},r.prototype.stop=function(){this.frame&&(r.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame,this.canvas.removeEventListener("mousemove",this.mousemove),this.canvas.removeEventListener("mouseout",this.mouseout))},r.prototype.updateValueRange=function(){for(var t=this.options,i=Number.NaN,a=Number.NaN,n=0;n<this.seriesSet.length;n++){var e=this.seriesSet[n].timeSeries;e.disabled||(isNaN(e.maxValue)||(i=isNaN(i)?e.maxValue:Math.max(i,e.maxValue)),isNaN(e.minValue)||(a=isNaN(a)?e.minValue:Math.min(a,e.minValue)))}if(t.maxValue!=null?i=t.maxValue:i*=t.maxValueScale,t.minValue!=null?a=t.minValue:a-=Math.abs(a*t.minValueScale-a),this.options.yRangeFunction){var s=this.options.yRangeFunction({min:a,max:i});a=s.min,i=s.max}if(!isNaN(i)&&!isNaN(a)){var o=i-a,u=o-this.currentValueRange,w=a-this.currentVisMinValue;this.isAnimatingScale=Math.abs(u)>.1||Math.abs(w)>.1,this.currentValueRange+=t.scaleSmoothing*u,this.currentVisMinValue+=t.scaleSmoothing*w}this.valueRange={min:a,max:i}},r.prototype.render=function(t,i){var a=Date.now();if(!(this.options.limitFPS>0&&a-this.lastRenderTimeMillis<1e3/this.options.limitFPS)){if(!this.isAnimatingScale){var n=Math.min(1e3/6,this.options.millisPerPixel);if(a-this.lastRenderTimeMillis<n)return}this.resize(),this.updateTooltip(),this.lastRenderTimeMillis=a,t=t||this.canvas,i=i||a-(this.delay||0),i-=i%this.options.millisPerPixel,this.lastChartTimestamp=i;var e=t.getContext("2d"),s=this.options,o={top:0,left:0,width:t.clientWidth,height:t.clientHeight},u=i-o.width*s.millisPerPixel,w=function(P){var O=P-this.currentVisMinValue;return this.currentValueRange===0?o.height:o.height-Math.round(O/this.currentValueRange*o.height)}.bind(this),F=function(P){return s.scrollBackwards?Math.round((i-P)/s.millisPerPixel):Math.round(o.width-(i-P)/s.millisPerPixel)};if(this.updateValueRange(),e.font=s.labels.fontSize+"px "+s.labels.fontFamily,e.save(),e.translate(o.left,o.top),e.beginPath(),e.rect(0,0,o.width,o.height),e.clip(),e.save(),e.fillStyle=s.grid.fillStyle,e.clearRect(0,0,o.width,o.height),e.fillRect(0,0,o.width,o.height),e.restore(),e.save(),e.lineWidth=s.grid.lineWidth,e.strokeStyle=s.grid.strokeStyle,s.grid.millisPerLine>0){e.beginPath();for(var d=i-i%s.grid.millisPerLine;d>=u;d-=s.grid.millisPerLine){var l=F(d);s.grid.sharpLines&&(l-=.5),e.moveTo(l,0),e.lineTo(l,o.height)}e.stroke(),e.closePath()}for(var f=1;f<s.grid.verticalSections;f++){var p=Math.round(f*o.height/s.grid.verticalSections);s.grid.sharpLines&&(p-=.5),e.beginPath(),e.moveTo(0,p),e.lineTo(o.width,p),e.stroke(),e.closePath()}if(s.grid.borderVisible&&(e.beginPath(),e.strokeRect(0,0,o.width,o.height),e.closePath()),e.restore(),s.horizontalLines&&s.horizontalLines.length)for(var M=0;M<s.horizontalLines.length;M++){var N=s.horizontalLines[M],W=Math.round(w(N.value))-.5;e.strokeStyle=N.color||"#ffffff",e.lineWidth=N.lineWidth||1,e.beginPath(),e.moveTo(0,W),e.lineTo(o.width,W),e.stroke(),e.closePath()}for(var y=0;y<this.seriesSet.length;y++){e.save();var V=this.seriesSet[y].timeSeries;if(!V.disabled){var b=V.data,h=this.seriesSet[y].options;V.dropOldData(u,s.maxDataSetLength),e.lineWidth=h.lineWidth,e.strokeStyle=h.strokeStyle,e.beginPath();for(var E=0,L=0,T=0,S=0;S<b.length&&b.length!==1;S++){var m=F(b[S][0]),g=w(b[S][1]);if(S===0)E=m,e.moveTo(m,g);else switch(s.interpolation){case"linear":case"line":{e.lineTo(m,g);break}case"bezier":default:{e.bezierCurveTo(Math.round((L+m)/2),T,Math.round(L+m)/2,g,m,g);break}case"step":{e.lineTo(m,T),e.lineTo(m,g);break}}L=m,T=g}b.length>1&&(h.fillStyle&&(e.lineTo(o.width+h.lineWidth+1,T),e.lineTo(o.width+h.lineWidth+1,o.height+h.lineWidth+1),e.lineTo(E,o.height+h.lineWidth),e.fillStyle=h.fillStyle,e.fill()),h.strokeStyle&&h.strokeStyle!=="none"&&e.stroke(),e.closePath()),e.restore()}}if(s.tooltip&&this.mouseX>=0&&(e.lineWidth=s.tooltipLine.lineWidth,e.strokeStyle=s.tooltipLine.strokeStyle,e.beginPath(),e.moveTo(this.mouseX,0),e.lineTo(this.mouseX,o.height),e.closePath(),e.stroke(),this.updateTooltip()),!s.labels.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){var D=s.yMaxFormatter(this.valueRange.max,s.labels.precision),x=s.yMinFormatter(this.valueRange.min,s.labels.precision),H=s.scrollBackwards?0:o.width-e.measureText(D).width-2,q=s.scrollBackwards?0:o.width-e.measureText(x).width-2;e.fillStyle=s.labels.fillStyle,e.fillText(D,H,s.labels.fontSize),e.fillText(x,q,o.height-2)}if(s.labels.showIntermediateLabels&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)&&s.grid.verticalSections>0)for(var X=(this.valueRange.max-this.valueRange.min)/s.grid.verticalSections,j=o.height/s.grid.verticalSections,f=1;f<s.grid.verticalSections;f++){var p=o.height-Math.round(f*j);s.grid.sharpLines&&(p-=.5);var R=s.yIntermediateFormatter(this.valueRange.min+f*X,s.labels.precision);intermediateLabelPos=s.labels.intermediateLabelSameAxis?s.scrollBackwards?0:o.width-e.measureText(R).width-2:s.scrollBackwards?o.width-e.measureText(R).width-2:0,e.fillText(R,intermediateLabelPos,p-s.grid.lineWidth)}if(s.timestampFormatter&&s.grid.millisPerLine>0)for(var k=s.scrollBackwards?e.measureText(x).width:o.width-e.measureText(x).width+4,d=i-i%s.grid.millisPerLine;d>=u;d-=s.grid.millisPerLine){var l=F(d);if(!s.scrollBackwards&&l<k||s.scrollBackwards&&l>k){var Y=new Date(d),A=s.timestampFormatter(Y),B=e.measureText(A).width;k=s.scrollBackwards?l+B+2:l-B-2,e.fillStyle=s.labels.fillStyle,s.scrollBackwards?e.fillText(A,l,o.height-2):e.fillText(A,l-B,o.height-2)}}e.restore()}},r.timeFormatter=function(t){function i(a){return(a<10?"0":"")+a}return i(t.getHours())+":"+i(t.getMinutes())+":"+i(t.getSeconds())},C.TimeSeries=c,C.SmoothieChart=r})(I)}),G=z.SmoothieChart,J=z.TimeSeries;export{G as SmoothieChart,J as TimeSeries};
