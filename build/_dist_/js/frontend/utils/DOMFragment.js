var p=Object.defineProperty;var o=(d,e,t)=>(typeof e!="symbol"&&(e+=""),e in d?p(d,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[e]=t);import{ObjectListener as m}from"./ObjectListener.js";export class DOMFragment{constructor(e=this.templateStringGen,t=document.body,n={},r=()=>{},i=()=>{},h="NEVER"){o(this,"onRender",()=>{});this.onRender=r,this.parentNode=t,typeof t=="string"&&(this.parentNode=document.getElementById(t)),this.renderSettings={templateStringGen:e,onchange:i,props:n},this.templateString="",typeof e=="function"?this.templateString=e(n):this.templateString=e;var s=h;if(this.renderSettings.props==={}&&(s="NEVER"),this.node=null,this.listener=new m,Object.keys(this.renderSettings.props).length>0&&!(s==null||s==="NEVER")){console.log("making listeners for ",e);const a=()=>{this.updateNode()};this.listener.addListener("templateChange",this.renderSettings,"templateStringGen",a,s);const l=()=>{this.updateNode(),this.renderSettings.onchange()};this.listener.addListener("props",this.renderSettings,"props",l,s)}this.renderNode()}appendFragment(e,t){var n=document.createElement("template");n.innerHTML=e;var r=n.content;return t.appendChild(r),t.children[t.children.length-1]}deleteFragment(e,t){var n=document.getElementById(t);e.removeChild(n)}removeParent(e){var t=document.getElementById(e);t.parentNode.parentNode.removeChild(t.parentNode)}renderNode(e=this.parentNode){this.node=this.appendFragment(this.templateString,e),this.onRender()}updateNode(e=this.parentNode,t=this.node,n=this.props){e.removeChild(t),typeof this.renderSettings.templateStringGen=="function"?this.templateString=this.renderSettings.templateStringGen(this.props):this.templateString=this.renderSettings.templateStringGen,this.renderNode(e,n)}deleteNode(e=this.node){typeof e=="string"?(thisNode=document.getElementById(e),thisNode.parentNode.removeChild(thisNode),this.node=null):typeof e=="object"&&(e.parentNode.removeChild(e),this.node=null)}appendStylesheet(e="",t=this.node){if(typeof e=="string"){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=e,t.insertAdjacentElement("afterbegin",n)}else if(Array.isArray(e))e.forEach(r=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=r,t.insertAdjacentElement("afterbegin",i)});else if(typeof e=="function"){let r=e();t.insertAdjacentHTML("afterbegin",r)}}}
