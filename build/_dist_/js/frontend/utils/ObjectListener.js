var p=Object.defineProperty;var a=(l,e,t)=>(typeof e!="symbol"&&(e+=""),e in l?p(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t);export class ObjectListener{constructor(e=!1){a(this,"addFunc",(e=null,t=null)=>{var n=null;if(t!==null)if(e===null)this.listeners.forEach((o,h)=>{n=o.listener.addFunc(t)});else var i=this.listeners.find((o,h)=>{o.key===e&&(n=o.listener.addFunc(t))});return n});a(this,"removeFuncs",(e=null,t=null)=>{if(e===null)this.listeners.forEach((i,o)=>{i.listener.removeFuncs(t)});else var n=this.listeners.find((i,o)=>{i.name===e&&i.listener.removeFuncs(t)})});this.debug=e,this.listeners=[]}addListener(e=null,t,n=void 0,i=void 0,o=void 0,h=this.debug){if(t===void 0){console.error("You must assign an object");return}var r=e;r===null&&(r=Math.floor(Math.random()*1e5));var s={key:r,listener:new ObjectListenerInstance(t,n,i,o,h)};this.listeners.push(s)}hasKey(e){var t=!1;return this.listeners.forEach((n,i)=>{n.key===e&&(t=!0)}),t}getKeyIndices(e){var t=[];return this.listeners.find((n,i)=>{n.key===e&&t.push(i)}),t}onchange(e=null,t=null){if(e===null)this.listeners.forEach((i,o)=>{i.listener.onchange=t});else var n=this.listeners.find((i,o)=>{i.name===e&&(i.listener.onchange=t)})}stop(e=null){if(e===null)this.listeners.forEach((n,i)=>{n.listener.stop()});else var t=this.listeners.find((n,i)=>{n.name===e&&n.listener.stop()})}start(e=null){if(e===null)this.listeners.forEach((n,i)=>{n.listener.start()});else var t=this.listeners.find((n,i)=>{n.name===e&&n.listener.start()})}remove(e=null){if(e===null)this.listeners.splice(0,this.listeners.length);else{var t=[],n=this.listeners.find((i,o)=>{i.name===e&&t.push(o)});t.reverse().forEach(i=>{this.listeners[i].stop(),this.listeners.splice(i,1)})}}}export class ObjectListenerInstance{constructor(e,t="__ANY__",n=this.onchange,i="FRAMERATE",o=!1){a(this,"onchange",e=>{console.log(this.propName," changed from: ",this.propOld," to: ",this.object[this.propName])});a(this,"addFunc",(e=null)=>(e!==null&&this.onchangeFuncs.push(e),this.onchangeFuncs.length-1));a(this,"onchangeMulti",e=>{this.onchangeFuncs.forEach((t,n)=>{this.debug===!0&&console.log(t),t(e)})});a(this,"setListenerRef",e=>{e==="__ANY__"||e===null||e===void 0?this.propOld=JSON.stringifyFast(this.object):Array.isArray(this.object[e])?this.propOld=JSON.stringifyFast(this.object[e].slice(this.object[e].length-20)):typeof this.object[e]=="object"?this.propOld=JSON.stringifyFast(this.object[e]):typeof this.object[e]=="function"?this.propOld=this.object[e].toString():this.propOld=this.object[e],this.debug===!0&&console.log("propname",e,", new assignment: ",this.propOld)});a(this,"check",()=>{this.propName==="__ANY__"||this.propName===null||this.propName===void 0?this.propOld!==JSON.stringifyFast(this.object)&&(this.debug===!0&&console.log("onchange: ",this.onchange),this.onchange(this.object),this.onchangeFuncs.length>0&&this.onchangeMulti(this.object),this.setListenerRef(this.propName)):Array.isArray(this.object[this.propName])?this.propOld!==JSON.stringifyFast(this.object[this.propName].slice(this.object[this.propName].length-20))&&(this.debug===!0&&console.log("onchange: ",this.onchange),this.onchange(this.object[this.propName]),this.onchangeFuncs.length>0&&this.onchangeMulti(this.object[this.propName]),this.setListenerRef(this.propName)):typeof this.object[this.propName]=="object"?this.propOld!==JSON.stringifyFast(this.object[this.propName])&&(this.debug===!0&&console.log("onchange: ",this.onchange),this.onchange(this.object[this.propName]),this.onchangeFuncs.length>0&&this.onchangeMulti(this.object[this.propName]),this.setListenerRef(this.propName)):typeof this.object[this.propName]=="function"?this.propOld!==this.object[this.propName].toString()&&(this.debug===!0&&console.log("onchange: ",this.onchange),this.onchange(this.object[this.propName].toString()),this.onchangeFuncs.length>0&&this.onchangeMulti(this.object[this.propName].toString()),this.setListenerRef(this.propName)):this.object[this.propName]!==this.propOld&&(this.debug===!0&&console.log("onchange: ",this.onchange),this.onchange(this.object[this.propName]),this.onchangeFuncs.length>0&&this.onchangeMulti(this.object[this.propName]),this.setListenerRef(this.propName)),this.running===!0&&(this.debug===!0&&console.log("checking",this.object,this.propName),this.interval==="FRAMERATE"?this.checker=requestAnimationFrame(this.check):setTimeout(()=>{this.check},this.interval))});this.debug=o,this.onchange=n,this.onchangeFuncs=[],this.object=e,this.propName=t,this.propOld=void 0,this.setListenerRef(t),this.running=!0,this.interval,i<=0?(this.interval=10,console.log("Min recommended interval set: 10ms")):this.interval=i,this.checker=requestAnimationFrame(this.check)}removeFuncs(e=null){e===null?this.onchangeFuncs=[]:this.onchangeFuncs[e]!==void 0&&this.onchangeFuncs.splice(e,1)}start(){this.running=!0,this.checker=requestAnimationFrame(this.check)}stop(){this.running=!1,cancelAnimationFrame(this.checker)}}export function sortObjectByValue(l){var e=[];for(var t in l)e.push([t,l[t]]);e.sort(function(i,o){var h=i,r=o;if(typeof h[1]=="function"?h[1]=h[1].toString():typeof h[1]=="object"&&(h[1]=JSON.stringifyFast(h[1])),typeof r[1]=="function"?r[1]=r[1].toString():typeof r[1]=="object"&&(r[1]=JSON.stringifyFast(r[1])),typeof h[1]=="string"){var s=0;h.forEach((f,c)=>{s+=h.charCodeAt(c)}),h=s}if(typeof r[1]=="string"){var s=0;r.forEach((c,g)=>{s+=r.charCodeAt(g)}),r=s}return h[1]-r[1]});var n={};return e.forEach(i=>{n[i[0]]=i[1]}),n}export function sortObjectByPropName(l){var e=[];for(var t in l)e.push([t,l[t]]);e.sort(function(i,o){return i[0]>o[0]});var n={};return e.forEach(i=>{n[i[0]]=i[1]}),n}JSON.stringifyFast===void 0&&(JSON.stringifyFast=function(){const l=new Map,e=[],t=["this"];function n(){l.clear(),e.length=0,t.length=1}function i(h,r){var s=e.length-1,f=e[s];if(f[h]===r||s===0)t.push(h),e.push(r);else for(;s-->=0;)if(f=e[s],f[h]===r){s+=2,e.length=s,t.length=s,--s,e[s]=r,t[s]=h;break}}function o(h,r){let s=r;if(s!==null&&typeof r=="object"){let f=l.get(s),c=r.constructor.name;if(f)return"[Circular Reference]"+f;if(c==="Array"&&r.length>20)s=r.slice(r.length-20),l.set(s,t.join("."));else if(c!=="Number"&&c!=="String"&&c!=="Boolean")s="instanceof_"+c,l.set(s,t.join("."));else if(typeof s=="object"){let g={};for(const u in s)Array.isArray(s[u])?g[u]=s[u].slice(s[u].length-20):g[u]=s[u]}else l.set(s,t.join("."))}return s}return function(r,s){try{return e.push(r),JSON.stringify(r,o,s)}finally{n()}}}());
