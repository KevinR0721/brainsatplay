export class eegmath{constructor(){}static genSineWave(r=20,t=1,a=1,e=512,v=0,h=1){for(var s=[],o=[],u=1/e,n=0;n<a;n+=u){var c=Math.sin(2*Math.PI*r*n)*t;c+=Math.sin(2*Math.PI*v*n)*h,s.push(c),o.push(n)}return[o,s]}static mean(r){var t=r.reduce((a,e)=>e+=a);return t/r.length}static variance(r){for(var t=this.mean(r),a=[],e=0;e<r.length;e++)a.push((r[e]-t)/(r.length-1));return a}static transpose(r){return r[0].map((t,a)=>r.map(e=>e[a]))}static matmul(r,t){for(var a=r.length,e=r[0].length,v=t.length,h=t[0].length,s=new Array(a),o=0;o<a;++o){s[o]=new Array(h);for(var u=0;u<h;++u){s[o][u]=0;for(var n=0;n<e;++n)s[o][u]+=r[o][n]*t[n][u]}}return s}static cov2d(r){var t=this.transpose(r),a=[],e=[],v=[];r.forEach((f,p)=>{e.push(this.mean(f))}),t.forEach((f,p)=>{v.push(this.mean(f))}),r.forEach((f,p)=>{a.push([]);for(var i=0;i<f.length;i++)a[p].push((r[p][i]-e[p])*(r[p][i]-v[i])/(f.length-1))}),console.log(a);for(var h=this.transpose(a),s=a.length,o=a[0].length,u=h.length,n=h[0].length,c=new Array(s),l=0;l<s;++l){c[l]=new Array(n);for(var m=0;m<n;++m){c[l][m]=0;for(var g=0;g<o;++g)c[l][m]+=a[l][g]*h[g][m]/(r[0].length-1)}}return c}static cov1d(r,t){return this.cov2d([r,t])}static crosscorrelation(r,t){var a=[...t,...Array(t.length).fill(0)],e=this.mean(r),v=this.mean(t),h=r.reduce((l,m)=>l+=Math.pow(m-e,2));h=Math.sqrt(h);var s=t.reduce((l,m)=>l+=Math.pow(m-e,2));s=Math.sqrt(s);for(var o=1/(h*s),u=new Array(r.length).fill(0),n=0;n<r.length;n++){var c=r.reduce((l,m,g)=>l+=(m-e)*(a[n+g]-v));u[n]=c*o}return u}static autocorrelation(r){var t=[...r,...Array(r.length).fill(0)],a=this.mean(r),e=r.reduce((u,n)=>u+=Math.pow(n-a,2));e=Math.sqrt(e);for(var v=1/(e*e),h=new Array(r.length).fill(0),s=0;s<r.length;s++){var o=r.reduce((u,n,c)=>u+=(n-a)*(t[s+c]-a));h[s]=o*v}return h}static correlograms(r){var t=[];return r.forEach((a,e)=>{r.forEach((v,h)=>{h>=e&&t.push(eegmath.crosscorrelation(a,v))})}),t}static sma(r,t){for(var a=[],e=0;e<r.length;e++)if(e==0)a.push(r[0]);else if(e<t){var v=r.slice(0,e+1);a.push(v.reduce((h,s)=>s+=h)/(e+1))}else{var v=r.slice(e-t,e);a.push(v.reduce((s,o)=>o+=s)/t)}return a}interpolateArray(r,t){var a=this.canvas.height/r.length,e=function(l,m,g){return(l+(m-l)*g)*a},v=new Array,h=new Number((r.length-1)/(t-1));v[0]=r[0];for(var s=1;s<t-1;s++){var o=s*h,u=new Number(Math.floor(o)).toFixed(),n=new Number(Math.ceil(o)).toFixed(),c=o-u;v[s]=e(r[u],r[n],c)}return v[t-1]=r[r.length-1],v}}
