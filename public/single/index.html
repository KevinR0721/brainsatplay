<!DOCTYPE html>
<html lang="en">
<head>
  <title>Brains@Play Platform</title>
  <meta charset="UTF-8" />
  <script src="../../src/library/dist/brainsatplay.js"></script>
<!-- <link href="../styles/css/global.css" rel="stylesheet"> -->
</head>
<body>
  <div id="sidebar" style="width: 100px; height: 100vh;">
  </div>
</body>
<script>

  let bci =  new brainsatplay.Session()
  bci.makeConnectOptions(document.getElementById('sidebar'),()=> {});
  
</script>

<script>

let username = ''
let httpsDomain = 'localhost:8000'
let subprotocolsArray = [`username&${username}`,'password&','appname&']
  // let connection = new WebSocket(httpDomain,subprotocolsArray);
// // or
let connection = new WebSocket('wss://' + httpsDomain, subprotocolsArray);

connection.onopen = () => {
  console.log('connection established!')
};

// Log errors
connection.onerror = (error) => {
  console.log('WebSocket Error: ' + error);
};

// Log messages from the server
connection.onmessage = (e) => {
  let parsed = JSON.parse(e.data)
  console.log('Server', parsed);

  if (parsed.msg == 'resetUsername'){
    username = parsed.username
    connection.send(JSON.stringify({
        username: username,
        cmd: 'ping'
    }))
    // connection.send(JSON.stringify([username,'ping']))
    // connection.send(JSON.stringify(`${username} ping`))

  }
};
</script>
</html>
